(this.webpackJsonpwhattowatch=this.webpackJsonpwhattowatch||[]).push([[0],{104:function(e,t,a){e.exports=a(133)},133:function(e,t,a){"use strict";a.r(t);var r,n=a(0),c=a.n(n),i=a(66),s=a.n(i),l=a(2),o=a(12),u=a(91),m=a(16),E=a(30),_=a(61),d=a(92),v=a.n(d),f=a(93),p=a.n(f),b=a(8);!function(e){e.FETCH_AUTH_REQUEST="FETCH_AUTH_REQUEST",e.FETCH_AUTH_SUCCESS="FETCH_AUTH_SUCCESS",e.FETCH_AUTH_FAIL="FETCH_AUTH_FAIL",e.FETCH_AUTH_STATUS_REQUEST="FETCH_AUTH_STATUS_REQUEST",e.FETCH_AUTH_STATUS_SUCCESS="FETCH_AUTH_STATUS_SUCCESS",e.FETCH_AUTH_STATUS_FAIL="FETCH_AUTH_STATUS_FAIL",e.AUTH_STATUS_UNAUTHORIZED="AUTH_STATUS_UNAUTHORIZED"}(r||(r={}));var h,g=Object(b.Map)({user:null,authError:null,isAuthFetching:!1,authStatusError:null,isAuthStatusFetching:!1}),S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.FETCH_AUTH_REQUEST:return e.set("authError",null).set("isAuthFetching",!0);case r.FETCH_AUTH_SUCCESS:return e.set("user",Object(b.Map)(t.payload)).set("isAuthFetching",!1);case r.FETCH_AUTH_FAIL:return e.set("user",null).set("isAuthFetching",!1).set("authError",t.payload);case r.FETCH_AUTH_STATUS_REQUEST:return e.set("authStatusError",null).set("isAuthStatusFetching",!0);case r.FETCH_AUTH_STATUS_SUCCESS:return e.set("user",Object(b.Map)(t.payload)).set("isAuthStatusFetching",!1);case r.FETCH_AUTH_STATUS_FAIL:return e.set("user",null).set("isAuthStatusFetching",!1).set("authStatusError",t.payload);case r.AUTH_STATUS_UNAUTHORIZED:return e.set("user",null).set("isAuthStatusFetching",!1);default:}return e};!function(e){e.FETCH_PROMO_REQUEST="FETCH_PROMO_REQUEST",e.FETCH_PROMO_SUCCESS="FETCH_PROMO_SUCCESS",e.FETCH_PROMO_FAIL="FETCH_PROMO_FAIL"}(h||(h={}));var O,T={promo:Object(b.Map)(),isPromoFetching:!0,promoError:null},F=Object(b.Map)(T),C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.FETCH_PROMO_REQUEST:return e.set("promoError",null).set("isPromoFetching",!0);case h.FETCH_PROMO_SUCCESS:return e.set("promo",Object(b.fromJS)(t.payload)).set("isPromoFetching",!1);case h.FETCH_PROMO_FAIL:return e.set("promo",Object(b.Map)()).set("isPromoFetching",!1).set("promoError",t.payload);default:}return e};!function(e){e.FETCH_FILMS_REQUEST="FETCH_FILMS_REQUEST",e.FETCH_FILMS_SUCCESS="FETCH_FILMS_SUCCESS",e.FETCH_FILMS_FAIL="FETCH_FILMS_FAIL",e.SET_FILTER="SET_FILTER",e.SET_FILM="SET_FILM"}(O||(O={}));var w,j={films:Object(b.List)(),isFilmsFetching:!0,filmsError:null,filter:"All genres",film:null},y=Object(b.Map)(j),R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O.FETCH_FILMS_REQUEST:return e.set("filmsError",null).set("isFilmsFetching",!0);case O.FETCH_FILMS_SUCCESS:return e.set("films",Object(b.fromJS)(t.payload)).set("isFilmsFetching",!1);case O.FETCH_FILMS_FAIL:return e.set("films",Object(b.List)()).set("isFilmsFetching",!1).set("filmsError",t.payload);case O.SET_FILTER:return e.set("filter",t.payload);case O.SET_FILM:return e.set("film",t.payload);default:}return e};!function(e){e.FETCH_REVIEWS_REQUEST="FETCH_REVIEWS_REQUEST",e.FETCH_REVIEWS_SUCCESS="FETCH_REVIEWS_SUCCESS",e.FETCH_REVIEWS_FAIL="FETCH_REVIEWS_FAIL",e.FETCH_REVIEW_REQUEST="FETCH_REVIEW_REQUEST",e.FETCH_REVIEW_SUCCESS="FETCH_REVIEW_SUCCESS",e.FETCH_REVIEW_FAIL="FETCH_REVIEW_FAIL",e.RESET_REVIEW_ERROR="RESET_REVIEW_ERROR"}(w||(w={}));var A,N={reviews:Object(b.fromJS)({id:null,data:Object(b.List)()}),isReviewsFetching:!0,reviewsError:null,isReviewFetching:!1,reviewError:null},H=Object(b.Map)(N),U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w.FETCH_REVIEWS_REQUEST:return e.set("reviewsError",null).set("isReviewsFetching",!0);case w.FETCH_REVIEWS_SUCCESS:return e.set("reviews",Object(b.fromJS)(t.payload)).set("isReviewsFetching",!1);case w.FETCH_REVIEWS_FAIL:return e.set("reviews",Object(b.fromJS)({id:null,data:Object(b.List)()})).set("isReviewsFetching",!1).set("reviewsError",t.payload);case w.FETCH_REVIEW_REQUEST:return e.set("reviewError",null).set("isReviewFetching",!0);case w.FETCH_REVIEW_SUCCESS:return e.set("reviews",Object(b.fromJS)(t.payload)).set("isReviewFetching",!1).set("isReviewsFetching",!1);case w.FETCH_REVIEW_FAIL:return e.set("isReviewFetching",!1).set("isReviewsFetching",!1).set("reviewError",t.payload);case w.RESET_REVIEW_ERROR:return e.set("reviewError",null);default:}return e};!function(e){e.FETCH_FAVORITES_REQUEST="FETCH_FAVORITES_REQUEST",e.FETCH_FAVORITES_SUCCESS="FETCH_FAVORITES_SUCCESS",e.FETCH_FAVORITES_FAIL="FETCH_FAVORITES_FAIL",e.FETCH_FAVORITE_REQUEST="FETCH_FAVORITE_REQUEST",e.FETCH_FAVORITE_SUCCESS="FETCH_FAVORITE_SUCCESS",e.FETCH_FAVORITE_FAIL="FETCH_FAVORITE_FAIL",e.RESET_FAVORITE_ERROR="RESET_FAVORITE_ERROR"}(A||(A={}));var I,x,k={favorites:Object(b.List)(),isFavoritesFetching:!0,favoritesError:null,isFavoriteFetching:!1,favoriteError:null},P=Object(b.Map)(k),L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A.FETCH_FAVORITES_REQUEST:return e.set("favoritesError",null).set("isFavoritesFetching",!0);case A.FETCH_FAVORITES_SUCCESS:var a=Array.isArray(t.payload)?t.payload:[t.payload];return e.set("favorites",Object(b.fromJS)(a)).set("isFavoritesFetching",!1);case A.FETCH_FAVORITES_FAIL:return e.set("favorites",Object(b.List)()).set("isFavoritesFetching",!1).set("favoritesError",t.payload);case A.FETCH_FAVORITE_REQUEST:return e.set("favoriteError",null).set("isFavoriteFetching",!0);case A.FETCH_FAVORITE_SUCCESS:return e.set("isFavoriteFetching",!1);case A.FETCH_FAVORITE_FAIL:return e.set("isFavoriteFetching",!1).set("favoriteError",t.payload);case A.RESET_FAVORITE_ERROR:return e.set("favoriteError",null);default:}return e},V={transforms:[p()()],key:"root",storage:v.a},M=Object(E.a)(),D=Object(o.connectRouter)(M),Q=Object(m.combineReducers)({router:D,auth:S,promo:C,films:R,reviews:U,favorites:L}),W=Object(_.persistReducer)(V,Q),G=a(94),B=a(95),q=a(103),J=a(4),z=a.n(J),Z=a(3),Y=function(){return{type:h.FETCH_PROMO_REQUEST}},K=function(e){return{type:h.FETCH_PROMO_SUCCESS,payload:e}},X=function(e){return{type:h.FETCH_PROMO_FAIL,error:!0,payload:e}},$="https://htmlacademy-react-3.appspot.com/wtw",ee={promo:{fetchPromo:function(){return fetch("".concat($,"/films/promo"))}},films:{fetchFilms:function(){return fetch("".concat($,"/films"))}},auth:{fetchAuth:function(e){return fetch("".concat($,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"})},fetchAuthStatus:function(){return fetch("".concat($,"/login"),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"})}},reviews:{fetchReviews:function(e){return fetch("".concat($,"/comments/").concat(e))},fetchReview:function(e,t){return fetch("".concat($,"/comments/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:t.rating,comment:t["review-text"]}),credentials:"include"})}},favorites:{fetchFavorites:function(){return fetch("".concat($,"/favorite"),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"})},fetchFavorite:function(e,t){return fetch("".concat($,"/favorite/").concat(e,"/").concat(t),{method:"POST",credentials:"include"})}}};!function(e){e.MAIN_PAGE="/",e.LOGIN_PAGE="/login",e.FILM_PAGE="/film/:id",e.REVIEW_PAGE="/film/:id/review",e.FAVORITES_PAGE="/mylist"}(I||(I={})),function(e){e[e.SUCCESS_STATUS_CODE=200]="SUCCESS_STATUS_CODE",e[e.NOT_FOUND_STATUS_CODE=404]="NOT_FOUND_STATUS_CODE",e[e.UNAUTHORIZED_STATUS_CODE=401]="UNAUTHORIZED_STATUS_CODE"}(x||(x={}));var te=z.a.mark(ae);function ae(){var e,t;return z.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Z.b)(ee.promo.fetchPromo);case 3:if((e=a.sent).status===x.SUCCESS_STATUS_CODE){a.next=6;break}throw new Error("Can't receive the promo film");case 6:return a.next=8,Object(Z.b)([e,e.json]);case 8:return t=a.sent,a.next=11,Object(Z.c)(K(t));case 11:a.next=17;break;case 13:return a.prev=13,a.t0=a.catch(0),a.next=17,Object(Z.c)(X(a.t0));case 17:case"end":return a.stop()}}),te,null,[[0,13]])}var re=z.a.mark(ce),ne=z.a.mark(ie);function ce(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(h.FETCH_PROMO_REQUEST,ae);case 2:case"end":return e.stop()}}),re)}function ie(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)([Object(Z.b)(ce)]);case 2:case"end":return e.stop()}}),ne)}var se=function(){return{type:O.FETCH_FILMS_REQUEST}},le=function(e){return{type:O.FETCH_FILMS_SUCCESS,payload:e}},oe=function(e){return{type:O.FETCH_FILMS_FAIL,error:!0,payload:e}},ue=function(e){return{type:O.SET_FILTER,payload:e}},me=function(e){return{type:O.SET_FILM,payload:e}},Ee=z.a.mark(_e);function _e(){var e,t;return z.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Z.b)(ee.films.fetchFilms);case 3:if((e=a.sent).status===x.SUCCESS_STATUS_CODE){a.next=6;break}throw new Error("Can't receive the list of films");case 6:return a.next=8,Object(Z.b)([e,e.json]);case 8:return t=a.sent,a.next=11,Object(Z.c)(le(t));case 11:a.next=17;break;case 13:return a.prev=13,a.t0=a.catch(0),a.next=17,Object(Z.c)(oe(a.t0));case 17:case"end":return a.stop()}}),Ee,null,[[0,13]])}var de=z.a.mark(fe),ve=z.a.mark(pe);function fe(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(O.FETCH_FILMS_REQUEST,_e);case 2:case"end":return e.stop()}}),de)}function pe(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)([Object(Z.b)(fe)]);case 2:case"end":return e.stop()}}),ve)}var be=function(e){return{type:r.FETCH_AUTH_REQUEST,payload:e}},he=function(e){return{type:r.FETCH_AUTH_SUCCESS,payload:e}},ge=function(e){return{type:r.FETCH_AUTH_FAIL,error:!0,payload:e}},Se=function(){return{type:r.FETCH_AUTH_STATUS_REQUEST}},Oe=function(e){return{type:r.FETCH_AUTH_STATUS_SUCCESS,payload:e}},Te=function(e){return{type:r.FETCH_AUTH_STATUS_FAIL,error:!0,payload:e}},Fe=function(){return{type:r.AUTH_STATUS_UNAUTHORIZED}},Ce=z.a.mark(we);function we(e){var t,a;return z.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(Z.b)(ee.auth.fetchAuth,e.payload);case 3:if((t=r.sent).status===x.SUCCESS_STATUS_CODE){r.next=6;break}throw new Error("Can't sign in");case 6:return r.next=8,Object(Z.b)([t,t.json]);case 8:return a=r.sent,r.next=11,Object(Z.c)(he(a));case 11:r.next=17;break;case 13:return r.prev=13,r.t0=r.catch(0),r.next=17,Object(Z.c)(ge(r.t0));case 17:case"end":return r.stop()}}),Ce,null,[[0,13]])}var je=z.a.mark(ye);function ye(){var e,t;return z.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Z.b)(ee.auth.fetchAuthStatus);case 3:if((e=a.sent).status!==x.SUCCESS_STATUS_CODE){a.next=12;break}return a.next=7,Object(Z.b)([e,e.json]);case 7:return t=a.sent,a.next=10,Object(Z.c)(Oe(t));case 10:a.next=18;break;case 12:if(e.status!==x.UNAUTHORIZED_STATUS_CODE){a.next=17;break}return a.next=15,Object(Z.c)(Fe());case 15:a.next=18;break;case 17:throw new Error("Can't check auth status");case 18:a.next=24;break;case 20:return a.prev=20,a.t0=a.catch(0),a.next=24,Object(Z.c)(Te(a.t0));case 24:case"end":return a.stop()}}),je,null,[[0,20]])}var Re=z.a.mark(He),Ae=z.a.mark(Ue),Ne=z.a.mark(Ie);function He(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(r.FETCH_AUTH_REQUEST,we);case 2:case"end":return e.stop()}}),Re)}function Ue(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(r.FETCH_AUTH_STATUS_REQUEST,ye);case 2:case"end":return e.stop()}}),Ae)}function Ie(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)([Object(Z.b)(He),Object(Z.b)(Ue)]);case 2:case"end":return e.stop()}}),Ne)}var xe=function(e){return{type:w.FETCH_REVIEWS_REQUEST,payload:e}},ke=function(e,t){return{type:w.FETCH_REVIEWS_SUCCESS,payload:{id:e,data:t}}},Pe=function(e){return{type:w.FETCH_REVIEWS_FAIL,error:!0,payload:e}},Le=function(e,t){return{type:w.FETCH_REVIEW_REQUEST,payload:{id:e,reviewData:t}}},Ve=function(e,t){return{type:w.FETCH_REVIEW_SUCCESS,payload:{id:e,data:t}}},Me=function(e){return{type:w.FETCH_REVIEW_FAIL,error:!0,payload:e}},De=function(){return{type:w.RESET_REVIEW_ERROR}},Qe=z.a.mark(We);function We(e){var t,a;return z.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(Z.b)(ee.reviews.fetchReviews,e.payload);case 3:if((t=r.sent).status===x.SUCCESS_STATUS_CODE){r.next=6;break}throw new Error("Can't receive the list of reviews");case 6:return r.next=8,Object(Z.b)([t,t.json]);case 8:return a=r.sent,r.next=11,Object(Z.c)(ke(e.payload,a));case 11:r.next=17;break;case 13:return r.prev=13,r.t0=r.catch(0),r.next=17,Object(Z.c)(Pe(r.t0));case 17:case"end":return r.stop()}}),Qe,null,[[0,13]])}var Ge=z.a.mark(Be);function Be(e){var t,a,r,n,c;return z.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,t=e.payload,a=t.id,r=t.reviewData,i.next=4,Object(Z.b)(ee.reviews.fetchReview,a,r);case 4:if((n=i.sent).status!==x.SUCCESS_STATUS_CODE){i.next=15;break}return i.next=8,Object(Z.b)([n,n.json]);case 8:return c=i.sent,i.next=11,Object(Z.c)(Ve(a,c));case 11:return i.next=13,Object(Z.c)(Object(o.push)("".concat("/whattowatch","/film/").concat(a)));case 13:i.next=20;break;case 15:if(n.status!==x.UNAUTHORIZED_STATUS_CODE){i.next=19;break}throw new Error("You're unauthorized. Please, sign in and retry");case 19:throw new Error("Can't save your review. Please, retry later");case 20:i.next=26;break;case 22:return i.prev=22,i.t0=i.catch(0),i.next=26,Object(Z.c)(Me(i.t0));case 26:case"end":return i.stop()}}),Ge,null,[[0,22]])}var qe=z.a.mark(Ze),Je=z.a.mark(Ye),ze=z.a.mark(Ke);function Ze(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(w.FETCH_REVIEWS_REQUEST,We);case 2:case"end":return e.stop()}}),qe)}function Ye(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(w.FETCH_REVIEW_REQUEST,Be);case 2:case"end":return e.stop()}}),Je)}function Ke(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)([Object(Z.b)(Ze),Object(Z.b)(Ye)]);case 2:case"end":return e.stop()}}),ze)}var Xe=function(){return{type:A.FETCH_FAVORITES_REQUEST}},$e=function(e){return{type:A.FETCH_FAVORITES_SUCCESS,payload:e}},et=function(e){return{type:A.FETCH_FAVORITES_FAIL,error:!0,payload:e}},tt=function(e,t){return{type:A.FETCH_FAVORITE_REQUEST,payload:{id:e,status:t}}},at=function(e){return{type:A.FETCH_FAVORITE_SUCCESS,payload:e}},rt=function(e){return{type:A.FETCH_FAVORITE_FAIL,error:!0,payload:e}},nt=function(){return{type:A.RESET_FAVORITE_ERROR}},ct=z.a.mark(it);function it(){var e,t;return z.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Z.b)(ee.favorites.fetchFavorites);case 3:if((e=a.sent).status===x.SUCCESS_STATUS_CODE){a.next=6;break}throw new Error("Can't receive the list of favorite films");case 6:return a.next=8,Object(Z.b)([e,e.json]);case 8:return t=a.sent,a.next=11,Object(Z.c)($e(t));case 11:a.next=17;break;case 13:return a.prev=13,a.t0=a.catch(0),a.next=17,Object(Z.c)(et(a.t0));case 17:case"end":return a.stop()}}),ct,null,[[0,13]])}var st=z.a.mark(lt);function lt(e){var t,a,r,n,c;return z.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,t=e.payload,a=t.id,r=t.status,i.next=4,Object(Z.b)(ee.favorites.fetchFavorite,a,r);case 4:if((n=i.sent).status!==x.SUCCESS_STATUS_CODE){i.next=15;break}return i.next=8,Object(Z.b)([n,n.json]);case 8:return c=i.sent,i.next=11,Object(Z.c)(at(c));case 11:return i.next=13,Object(Z.c)(Xe());case 13:i.next=20;break;case 15:if(n.status!==x.UNAUTHORIZED_STATUS_CODE){i.next=19;break}throw new Error("You're unauthorized. Please, sign in and retry");case 19:throw new Error("Can't save the film to the favorites list. Please, retry later");case 20:i.next=26;break;case 22:return i.prev=22,i.t0=i.catch(0),i.next=26,Object(Z.c)(rt(i.t0));case 26:case"end":return i.stop()}}),st,null,[[0,22]])}var ot=z.a.mark(Et),ut=z.a.mark(_t),mt=z.a.mark(dt);function Et(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(A.FETCH_FAVORITES_REQUEST,it);case 2:case"end":return e.stop()}}),ot)}function _t(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(A.FETCH_FAVORITE_REQUEST,lt);case 2:case"end":return e.stop()}}),ut)}function dt(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)([Object(Z.b)(Et),Object(Z.b)(_t)]);case 2:case"end":return e.stop()}}),mt)}var vt=z.a.mark(ft);function ft(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)([Object(Z.b)(ie),Object(Z.b)(pe),Object(Z.b)(Ie),Object(Z.b)(Ke),Object(Z.b)(dt)]);case 2:case"end":return e.stop()}}),vt)}var pt=Object(o.routerMiddleware)(M),bt=Object(q.a)(),ht=[bt,pt];Object(G.createLogger)({duration:!0,collapsed:!0,colors:{title:function(e){return e.error?"firebrick":"deepskyblue"},prevState:function(){return"#1C5FAF"},action:function(){return"#149945"},nextState:function(){return"#A47104"},error:function(){return"#ff0005"}}});var gt=Object(m.createStore)(W,Object(B.composeWithDevTools)(m.applyMiddleware.apply(void 0,ht))),St=Object(_.persistStore)(gt);bt.run(ft);var Ot,Tt=a(88),Ft=a(34),Ct=a.n(Ft),wt=function(e){return e.auth.get("user")},jt=function(e){return e.auth.get("authError")},yt=function(e){return e.auth.get("isAuthFetching")},Rt=function(e){return e.auth.get("authStatusError")},At=function(e){return e.auth.get("isAuthStatusFetching")},Nt=function(e){return e.promo.get("isPromoFetching")},Ht=function(e){return e.promo.get("promoError")},Ut=function(e){return e.promo.get("promo")},It=function(){var e=Object(Tt.useLocation)().pathname==="".concat("/whattowatch").concat(I.MAIN_PAGE),t=Object(l.useDispatch)();return Object(n.useCallback)((function(){e||t(Object(o.push)("".concat("/whattowatch").concat(I.MAIN_PAGE)))}),[e,t])},xt=function(e){var t=e.isMainPage,a=e.logoLinkClickHandler,r=e.isFooter,n=t?{}:{cursor:"pointer"},i=Ct()("logo__link",{"logo__link--light":r});return c.a.createElement("div",{className:"logo"},c.a.createElement("a",{className:i,onClick:a,style:n,title:t?"":"To the main page"},c.a.createElement("span",{className:"logo__letter logo__letter--1"},"W"),c.a.createElement("span",{className:"logo__letter logo__letter--2"},"T"),c.a.createElement("span",{className:"logo__letter logo__letter--3"},"W")))},kt=function(e){var t=Object(l.useDispatch)();return Object(n.useCallback)((function(){t(Object(o.push)("".concat("/whattowatch","/film/").concat(e)))}),[t,e])},Pt=function(e){var t,a,r,i,s=e.film,u=Object(l.useSelector)(wt),m=Object(l.useSelector)(Ut),E=Object(l.useSelector)(Rt),_=Object(l.useSelector)(At),d=Object(l.useDispatch)();s?(t=s.get("background_image"),a=s.get("name"),r=s.get("poster_image"),i=s.get("id")):(t=m.get("background_image"),a=m.get("name"));var v,f=Object(Tt.useLocation)().pathname,p=f.includes("film")&&!f.includes("review"),b=f==="".concat("/whattowatch").concat(I.MAIN_PAGE),h=f.includes("review"),g=f==="".concat("/whattowatch").concat(I.FAVORITES_PAGE),S=It(),O=function(){var e=Object(Tt.useLocation)().pathname==="".concat("/whattowatch").concat(I.LOGIN_PAGE),t=Object(l.useDispatch)();return{signInLinkClickHandler:Object(n.useCallback)((function(){e||t(Object(o.push)("".concat("/whattowatch").concat(I.LOGIN_PAGE)))}),[e,t]),isLoginPage:e}}(),T=O.signInLinkClickHandler,F=O.isLoginPage,C=kt(i),w=Object(n.useCallback)((function(){g||d(Object(o.push)("".concat("/whattowatch").concat(I.FAVORITES_PAGE)))}),[d,g]),j=c.a.createElement("div",{className:"user-block"},c.a.createElement("a",{className:"user-block__link",onClick:T,title:"To the login page"},"Sign in"));if(_)j=c.a.createElement("div",{className:"user-block"},"Authorization...");else if(E)j=c.a.createElement("div",{className:"user-block"},"Authorization failed");else if(u){v=u.get("avatar_url");var y=g?{cursor:"default"}:{};j=c.a.createElement("div",{className:"user-block"},c.a.createElement("div",{className:"user-block__avatar"},c.a.createElement("img",{src:"https://htmlacademy-react-3.appspot.com/".concat(v),onClick:w,height:"63",alt:"User avatar",width:"63",title:g?"":"To the favorites page",style:y})))}var R=Ct()("page-header",{"user-page__head":F||g,"movie-card__head":p});return c.a.createElement(c.a.Fragment,null,!F&&!g&&c.a.createElement("div",{className:"movie-card__bg"},c.a.createElement("img",{src:t,alt:a})),c.a.createElement("h1",{className:"visually-hidden"},"WTW"),c.a.createElement("header",{className:R},c.a.createElement(xt,{isMainPage:b,logoLinkClickHandler:S}),h&&c.a.createElement("nav",{className:"breadcrumbs"},c.a.createElement("ul",{className:"breadcrumbs__list"},c.a.createElement("li",{className:"breadcrumbs__item"},c.a.createElement("a",{className:"breadcrumbs__link breadcrumbs__link--active",onClick:C,title:"To the film page"},a)),c.a.createElement("li",{className:"breadcrumbs__item"},c.a.createElement("a",{className:"breadcrumbs__link"},"Add review")))),(F||g)&&c.a.createElement("h1",{className:"page-title  user-page__title"},F?"Sign in":"My list"),!F&&j),h&&c.a.createElement("div",{className:"movie-card__poster movie-card__poster--small"},c.a.createElement("img",{src:r,alt:a,width:"218",height:"327"})))},Lt=a(96),Vt=a.n(Lt),Mt=function(e){var t=e?e/60|0:0,a=e?e%60|0:0;return Vt.a.utc().hours(t).minutes(a).seconds(0).format("h:mm:ss")},Dt=function(e){return null!==e.current},Qt=function(e){return 0!==e.size},Wt=a(23),Gt=a(44),Bt=a(45);function qt(){var e=Object(Gt.a)(["\n    left: 153px;\n    top: 78px;\n    position: absolute;\n    animation: "," linear 1s infinite;\n    background: #831a19;\n    width: 19px;\n    height: 39px;\n    border-radius: 9px / 19px;\n    transform-origin: 9px 85px;\n    box-sizing: content-box;\n    transform: ",";\n    animation-delay: ",";\n"]);return qt=function(){return e},e}function Jt(){var e=Object(Gt.a)(["\n    width: 327px;\n    height: 327px;\n    display: block;\n    overflow: hidden;\n    background: transparent;\n    margin: 0 auto;\n    position: relative;\n    transform: translateZ(0) scale(1);\n    backface-visibility: hidden;\n    transform-origin: 0 0;\n"]);return Jt=function(){return e},e}function zt(){var e=Object(Gt.a)(["\n    0% {\n        opacity: 1\n    }\n\n    100% {\n        opacity: 0\n    }\n"]);return zt=function(){return e},e}var Zt=Object(Bt.b)(zt()),Yt=Bt.a.div(Jt()),Kt=Bt.a.div(qt(),Zt,(function(e){return e.rotate}),(function(e){return e.delay})),Xt=[0,30,60,90,120,150,180,210,240,270,300,330],$t=[-.9166666666666666,-.8333333333333334,-.75,-.6666666666666666,-.583333333333333,-.5,-.4166666666666667,-.3333333333333333,-.25,-.16666666666666666,-.08333333333333333,0],ea=function(){return c.a.createElement(Yt,null,n.Children.toArray(new Array(12).fill("").map((function(e,t){return c.a.createElement(Kt,{rotate:"rotate(".concat(Xt[t],"deg)"),delay:"".concat($t[t],"s")})}))))},ta=Object(n.memo)(Object(n.forwardRef)((function(e,t){var a=e.handleExitBtnClick,r=e.src,i=e.posterImage,s=e.runTime,l=e.isPlaying,o=e.isVideoLoading,u=e.onCanPlayThroughHandler,m=function(e){var t=Object(n.useState)(0),a=Object(Wt.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){return Dt(e)&&e&&(Ot=setInterval((function(){c(e.current.currentTime/e.current.duration*100)}),1e3)),function(){return clearInterval(Ot)}}),[e]),isFinite(r)?r:0}(t),E=function(e,t,a){var r=Object(n.useState)(!1),c=Object(Wt.a)(r,2),i=c[0],s=c[1];Object(n.useEffect)((function(){s(e)}),[e]);var l=Object(n.useCallback)((function(){Dt(t)&&(i?t.current.pause():t.current.play()),s((function(e){return!e}))}),[i,t]),o=Object(n.useCallback)((function(){Dt(t)&&(a(),t.current.currentTime=0,i&&t.current.pause())}),[a,t,i]);return{isActive:i,playPauseBtnHandler:l,exitBtnClickHandler:o}}(l,t,a),_=E.isActive,d=E.playPauseBtnHandler,v=E.exitBtnClickHandler,f=l?{}:{display:"none"},p=Object(n.useMemo)((function(){return Mt(s*(100-m))}),[s,m]);return o?c.a.createElement("div",{className:"player",style:f},c.a.createElement(ea,null),c.a.createElement("video",{className:"player__video",src:r,ref:t,onCanPlayThrough:u})):c.a.createElement("div",{className:"player",style:f},c.a.createElement("video",{className:"player__video",src:r,poster:i,ref:t}),c.a.createElement("button",{type:"button",className:"player__exit",onClick:v,title:"Exit"},"Exit"),c.a.createElement("div",{className:"player__controls"},c.a.createElement("div",{className:"player__controls-row"},c.a.createElement("div",{className:"player__time"},c.a.createElement("progress",{className:"player__progress",value:m,max:"100"}),c.a.createElement("div",{className:"player__toggler",style:{left:"".concat(m,"%")}},"Toggler")),c.a.createElement("div",{className:"player__time-value"},p)),c.a.createElement("div",{className:"player__controls-row"},c.a.createElement("button",{type:"button",className:"player__play",onClick:d,title:_?"Pause":"Play"},c.a.createElement("svg",{viewBox:_?"0 0 14 21":"0 0 320.001 320.001",width:"14",height:"21"},c.a.createElement("use",{xlinkHref:_?"#pause":"#play"})),c.a.createElement("span",null,_?"Pause":"Play")),c.a.createElement("div",{className:"player__name"},"Transpotting"),c.a.createElement("button",{type:"button",className:"player__full-screen",onClick:function(){Dt(t)&&t.current.requestFullscreen()},title:"Full screen"},c.a.createElement("svg",{viewBox:"0 0 27 27",width:"27",height:"27"},c.a.createElement("use",{xlinkHref:"#full-screen"})),c.a.createElement("span",null,"Full screen")))))}))),aa=function(){var e=Object(n.useState)(!1),t=Object(Wt.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(!0),i=Object(Wt.a)(c,2),s=i[0],l=i[1],o=Object(n.useRef)(null),u=Object(n.useCallback)((function(){o&&o.current&&(o.current.play(),r(!0),document.body.style.overflow="hidden")}),[]),m=Object(n.useCallback)((function(){r(!1),document.body.style.overflow="visible"}),[]),E=Object(n.useCallback)((function(){l(!1)}),[]);return{videoRef:o,isPlaying:a,handleExitBtnClick:m,playBtnClickHandler:u,isVideoLoading:s,onCanPlayThroughHandler:E}},ra=a(59),na=function(e){return e.favorites.get("isFavoritesFetching")},ca=function(e){return e.favorites.get("favoritesError")},ia=function(e){return e.favorites.get("favorites")},sa=function(e){return e.favorites.get("isFavoriteFetching")},la=function(e){return e.favorites.get("favoriteError")},oa=function(e){return e.films.get("isFilmsFetching")},ua=function(e){return e.films.get("filmsError")},ma=function(e){return e.films.get("films")},Ea=Object(ra.a)(ma,(function(e){if(Qt(e)){var t=e.map((function(e){return e.get("genre")})).toSet().slice(0,9).sort();return Object(b.Set)(["All genres"]).concat(t)}})),_a=function(e){return e.films.get("filter")},da=function(e){return e.films.get("film")},va=Object(ra.a)(ma,_a,(function(e,t){if(Qt(e))return"All genres"===t?e:e.filter((function(e){return e.get("genre")===t}))})),fa=function(e){var t,a=Object(l.useDispatch)(),r=Object(l.useSelector)(ma);if("number"===typeof e)t=e;else if(Qt(r)){var c=r.find((function(t){return t.get("name")===e.get("name")}));t=c.get("id")}var i=Object(l.useSelector)(function(e){return Object(ra.a)(ia,(function(t){return!!Qt(t)&&t.find((function(t){return t.get("id")===e}))}))}(t)),s=i?0:1,o=Object(n.useCallback)((function(){a(tt(t,s))}),[a,s,t]),u=Object(l.useSelector)(la);return{isFavoriteFetching:Object(l.useSelector)(sa),favoriteError:u,myListBtnClickHandler:o,isFavorite:i}};function pa(){var e=Object(Gt.a)(["\n    position: fixed;\n    right: 0;\n    bottom: 0;\n    min-height: 50px;\n    width: 300px;\n    outline: 1px solid red;\n    padding: 10px 20px;\n    background-color: black;\n    opacity: 0;\n    animation: "," linear 5s;\n"]);return pa=function(){return e},e}function ba(){var e=Object(Gt.a)(["\n    0% {\n        opacity: 0\n    }\n\n    50% {\n        opacity: 1\n    }\n\n    100% {\n        opacity: 0\n    }\n"]);return ba=function(){return e},e}var ha=Object(Bt.b)(ba()),ga=Bt.a.div(pa(),ha),Sa=Object(n.memo)((function(e){var t=e.children;return c.a.createElement(ga,null,t)})),Oa=Object(n.memo)((function(e){var t=e.playBtnClickHandler,a=e.detailed,r=Object(Tt.useParams)().id,i=Object(l.useDispatch)(),s=Object(l.useSelector)(Ut),u=Object(l.useSelector)(wt);Object(n.useEffect)((function(){i(nt())}),[i]);var m,E=Object(n.useCallback)((function(){i(Object(o.push)("".concat("/whattowatch","/film/").concat(r,"/review")))}),[i,r]);m=!r&&function(e){return 0!==e.size}(s)?s:+r;var _=fa(m),d=_.myListBtnClickHandler,v=_.isFavorite,f=_.isFavoriteFetching,p=_.favoriteError;return c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{className:"btn btn--play movie-card__button",type:"button",title:"Play",onClick:t},c.a.createElement("svg",{viewBox:"0 0 19 19",width:"19",height:"19"},c.a.createElement("use",{xlinkHref:"#play"})),c.a.createElement("span",null,"Play")),c.a.createElement("button",{className:"btn btn--list movie-card__button",type:"button",title:"My list",onClick:d},c.a.createElement("svg",{viewBox:"0 0 19 20",width:"19",height:"20"},c.a.createElement("use",{xlinkHref:v&&u?"#in-list":"#add"})),c.a.createElement("span",null,"My list")),a&&c.a.createElement("a",{className:"btn btn--add-review movie-card__button",title:"Add review",onClick:E},"Add review"),(f||p)&&c.a.createElement(Sa,null,f?"Saving to the favorites list... Please, wait":p.message))})),Ta=Object(n.memo)((function(e){var t=e.promo,a=aa(),r=a.isPlaying,n=a.handleExitBtnClick,i=a.playBtnClickHandler,s=a.videoRef,l=a.isVideoLoading,o=a.onCanPlayThroughHandler,u=t.get("name");return c.a.createElement("div",{className:"movie-card__wrap"},c.a.createElement("div",{className:"movie-card__info"},c.a.createElement("div",{className:"movie-card__poster"},c.a.createElement("img",{src:t.get("preview_image"),alt:"".concat(u," poster"),width:"218",height:"327"})),c.a.createElement("div",{className:"movie-card__desc"},c.a.createElement("h2",{className:"movie-card__title"},u),c.a.createElement("p",{className:"movie-card__meta"},c.a.createElement("span",{className:"movie-card__genre"},t.get("genre")),c.a.createElement("span",{className:"movie-card__year"},t.get("released"))),c.a.createElement("div",{className:"movie-card__buttons"},c.a.createElement(Oa,{playBtnClickHandler:i}))),c.a.createElement(ta,{src:t.get("video_link"),posterImage:t.get("poster_image"),runTime:t.get("run_time"),ref:s,isPlaying:r,handleExitBtnClick:n,isVideoLoading:l,onCanPlayThroughHandler:o})))})),Fa=function(){var e=function(){var e=Object(l.useDispatch)(),t=Object(l.useSelector)(Ut);return Object(n.useEffect)((function(){e(Y())}),[e]),{isPromoFetching:Object(l.useSelector)(Nt),promoError:Object(l.useSelector)(Ht),promo:t}}(),t=e.isPromoFetching,a=e.promoError,r=e.promo;return t?c.a.createElement(ea,null):a?c.a.createElement("div",null,"error"):c.a.createElement(Ta,{promo:r})},Ca=function(){var e=Object(l.useDispatch)(),t=Object(l.useSelector)(ma);Object(n.useEffect)((function(){e(se())}),[e]);var a=Object(l.useSelector)(ua);return{isFilmsFetching:Object(l.useSelector)(oa),filmsError:a,films:t}},wa=Object(n.memo)((function(e){var t=e.film,a=t.get("name"),r=t.get("id"),n=kt(r);return c.a.createElement("article",{className:"small-movie-card catalog__movies-card",title:a},c.a.createElement("div",{className:"small-movie-card__image",onClick:n},c.a.createElement("img",{src:t.get("preview_image"),alt:a,width:"280",height:"175"})),c.a.createElement("h3",{className:"small-movie-card__title"},c.a.createElement("a",{className:"small-movie-card__link"},a)))})),ja=c.a.memo((function(e){var t=e.films.map((function(e){return c.a.createElement(wa,{key:e.get("id"),film:e})}));return c.a.createElement("div",{className:"catalog__movies-list"},t)})),ya=function(){var e,t,a=Ca(),r=a.isFilmsFetching,i=a.filmsError,s=a.films,o=function(){var e=Object(n.useState)(20),t=Object(Wt.a)(e,2),a=t[0],r=t[1];return{batch:a,requestNextBatch:function(){return r((function(e){return e+20}))}}}(),u=o.batch,m=o.requestNextBatch,E=Object(l.useSelector)(va),_=Object(n.useCallback)(m,[]);return Qt(s)&&(t=(e=E.slice(0,u)).size<E.size),r?c.a.createElement(ea,null):i?c.a.createElement("div",null,"Error"):c.a.createElement(c.a.Fragment,null,c.a.createElement(ja,{films:e}),c.a.createElement("div",{className:"catalog__more"},t&&c.a.createElement("button",{className:"catalog__button",type:"button",onClick:_,title:"Show more"},"Show more")))},Ra=function(){var e,t=Object(l.useSelector)(Ea),a=Object(l.useSelector)(ua),r=Object(l.useSelector)(oa),i=function(){var e=Object(l.useSelector)(_a),t=Object(l.useDispatch)(),a=Object(n.useCallback)((function(a){a!==e&&t(ue(a))}),[t,e]);return{filter:e,genreItemClickHander:a}}(),s=i.filter,o=i.genreItemClickHander;return a||r?null:(function(e){return void 0!==e}(t)&&(e=t.map((function(e){var t=e===s,a=Ct()("catalog__genres-item",{"catalog__genres-item--active":t}),r=t?{cursor:"default"}:{};return c.a.createElement("li",{className:a,key:e},c.a.createElement("a",{className:"catalog__genres-link",onClick:function(){return o(e)},title:t?"":e,style:r},e))}))),c.a.createElement("ul",{className:"catalog__genres-list"},e))},Aa=function(){var e=It(),t=Object(Tt.useLocation)().pathname==="".concat("/whattowatch").concat(I.MAIN_PAGE);return c.a.createElement("footer",{className:"page-footer"},c.a.createElement(xt,{isMainPage:t,logoLinkClickHandler:e,isFooter:!0}),c.a.createElement("div",{className:"copyright"},c.a.createElement("p",null,"\xa9 2020 What to watch Ltd.")))},Na=function(){var e=Object(l.useSelector)(Ut),t={};if(e){var a=e.get("background_color");t={backgroundImage:"linear-gradient(-180deg, ".concat(a," 0%, ").concat(a," 100%)")}}return c.a.createElement(c.a.Fragment,null,c.a.createElement("section",{className:"movie-card"},c.a.createElement(Pt,null),c.a.createElement(Fa,null)),c.a.createElement("div",{className:"page-content",style:t},c.a.createElement("section",{className:"catalog"},c.a.createElement("h2",{className:"catalog__title visually-hidden"},"Catalog"),c.a.createElement(Ra,null),c.a.createElement(ya,null)),c.a.createElement(Aa,null)))},Ha=a(18),Ua=a(46),Ia={initialValues:{email:"",password:""},schema:Object(Ua.a)().shape({email:Object(Ua.b)().min(6,"Email should be more than 6 characters").required("Email is required field").email("Invalid email").trim(),password:Object(Ua.b)().min(6,"Password should be more than 6 characters").max(15,"Password should be less than 15 characters").required("Password is required field").trim()})},xa={initialValues:{rating:"","review-text":""},schema:Object(Ua.a)().shape({rating:Object(Ua.b)().required("Rating is required"),"review-text":Object(Ua.b)().min(50,"Review should be more than 50 characters").max(400,"Review should be less than 400 characters").required("Review is required field").trim()})},ka=Object(n.memo)((function(e){var t=e.loginFormSubmitHandler,a=Object(l.useSelector)(jt);return c.a.createElement(Ha.d,{initialValues:Ia.initialValues,onSubmit:t,validationSchema:Ia.schema},(function(e){var t=e.isValid;return c.a.createElement(Ha.c,{className:"sign-in__form"},c.a.createElement(Ha.a,{name:"email"},(function(e){return c.a.createElement("div",{className:"sign-in__message"},c.a.createElement("p",null,e))})),c.a.createElement(Ha.a,{name:"password"},(function(e){return c.a.createElement("div",{className:"sign-in__message"},c.a.createElement("p",null,e))})),a&&c.a.createElement("div",{className:"sign-in__message"},c.a.createElement("p",null,"We can\u2019t recognize this email ",c.a.createElement("br",null)," and password combination. Please try again.")),c.a.createElement("div",{className:"sign-in__fields"},c.a.createElement("div",{className:"sign-in__field"},c.a.createElement(Ha.b,{className:"sign-in__input",type:"email",placeholder:"Email address",name:"email",id:"user-email"}),c.a.createElement("label",{className:"sign-in__label visually-hidden",htmlFor:"user-email"},"Email address")),c.a.createElement("div",{className:"sign-in__field"},c.a.createElement(Ha.b,{className:"sign-in__input",type:"password",placeholder:"Password",name:"password",id:"user-password"}),c.a.createElement("label",{className:"sign-in__label visually-hidden",htmlFor:"user-password"},"Password"))),c.a.createElement("div",{className:"sign-in__submit"},c.a.createElement("button",{className:"sign-in__btn",type:"submit",title:"Sign in",disabled:!t},"Sign in")))}))})),Pa=function(){var e=function(){var e=Object(l.useDispatch)(),t=Object(n.useCallback)((function(t){var a=t.email,r=t.password;e(be({email:a,password:r}))}),[e]),a=Object(l.useSelector)(wt),r=Object(l.useSelector)(jt);return{isAuthFetching:Object(l.useSelector)(yt),authError:r,user:a,loginFormSubmitHandler:t}}(),t=e.isAuthFetching,a=e.loginFormSubmitHandler;return t?c.a.createElement(ea,null):c.a.createElement("div",{className:"sign-in user-page__content"},c.a.createElement(ka,{loginFormSubmitHandler:a}))},La=function(){return Object(l.useSelector)(wt)?c.a.createElement(Tt.Redirect,{to:I.MAIN_PAGE}):c.a.createElement("div",{className:"user-page"},c.a.createElement(Pt,null),c.a.createElement(Pa,null),c.a.createElement(Aa,null))},Va=Object(n.memo)((function(e){var t=e.rating,a=e.scoresCount,r=e.description,n=e.director,i=e.starring;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"movie-rating"},c.a.createElement("div",{className:"movie-rating__score"},t),c.a.createElement("p",{className:"movie-rating__meta"},c.a.createElement("span",{className:"movie-rating__level"},function(e){switch(Math.floor(e)){case 10:return"Awesome";case 9:case 8:return"Very good";case 7:case 6:case 5:return"Good";case 4:case 3:return"Normal";case 2:case 1:case 0:return"Bad"}return"User's mark"}(+t)),c.a.createElement("span",{className:"movie-rating__count"},"".concat(a," ratings")))),c.a.createElement("div",{className:"movie-card__text"},c.a.createElement("p",null,r),c.a.createElement("p",{className:"movie-card__director"},c.a.createElement("strong",null,"Director: ".concat(n))),c.a.createElement("p",{className:"movie-card__starring"},c.a.createElement("strong",null,"Starring: ".concat(i.join(", "))))))})),Ma=Object(n.memo)((function(e){var t=e.released,a=e.runTime,r=e.genre,n=e.director,i=e.starring;return c.a.createElement("div",{className:"movie-card__text movie-card__row"},c.a.createElement("div",{className:"movie-card__text-col"},c.a.createElement("p",{className:"movie-card__details-item"},c.a.createElement("strong",{className:"movie-card__details-name"},"Director"),c.a.createElement("span",{className:"movie-card__details-value"},n)),c.a.createElement("p",{className:"movie-card__details-item"},c.a.createElement("strong",{className:"movie-card__details-name"},"Starring"),c.a.createElement("span",{className:"movie-card__details-value"},i.join(",\n")))),c.a.createElement("div",{className:"movie-card__text-col"},c.a.createElement("p",{className:"movie-card__details-item"},c.a.createElement("strong",{className:"movie-card__details-name"},"Run Time"),c.a.createElement("span",{className:"movie-card__details-value"},Mt(a))),c.a.createElement("p",{className:"movie-card__details-item"},c.a.createElement("strong",{className:"movie-card__details-name"},"Genre"),c.a.createElement("span",{className:"movie-card__details-value"},r)),c.a.createElement("p",{className:"movie-card__details-item"},c.a.createElement("strong",{className:"movie-card__details-name"},"Released"),c.a.createElement("span",{className:"movie-card__details-value"},t))))})),Da=function(e){return e.reviews.get("isReviewsFetching")},Qa=function(e){return e.reviews.get("reviewsError")},Wa=function(e){return e.reviews.getIn(["reviews","data"])},Ga=function(e){return e.reviews.getIn(["reviews","id"])},Ba=function(e){return e.reviews.get("isReviewFetching")},qa=function(e){return e.reviews.get("reviewError")},Ja=Object(n.memo)((function(e){var t,a=e.review,r=new Date(Date.parse(a.get("date"))),n=r.getFullYear(),i=r.getMonth(),s=r.getDate();return c.a.createElement("div",{className:"review"},c.a.createElement("blockquote",{className:"review__quote"},c.a.createElement("p",{className:"review__text"},a.get("comment")),c.a.createElement("footer",{className:"review__details"},c.a.createElement("cite",{className:"review__author"},a.getIn(["user","name"])),c.a.createElement("time",{className:"review__date",dateTime:"".concat(n,"-").concat(i+1,"-").concat(s)},"".concat((t=i,["January","February","March","April","May","June","July","August","September","October","November","December"][t])," ").concat(s,", ").concat(n)))),c.a.createElement("div",{className:"review__rating"},a.get("rating")))})),za=Object(n.memo)((function(e){var t,a,r,i=function(e){var t=Object(l.useDispatch)(),a=Object(l.useSelector)(Wa),r=Object(l.useSelector)(Ga);Object(n.useEffect)((function(){r!==e&&t(xe(e))}),[t,e,r,a]);var c=Object(l.useSelector)(Qa);return{isReviewsFetching:Object(l.useSelector)(Da),reviewsError:c,reviews:a}}(e.id),s=i.isReviewsFetching,o=i.reviewsError,u=i.reviews;return s?c.a.createElement(ea,null):o?c.a.createElement("div",null,"Error"):(function(e){return 0!==e.size}(u)&&(a=(t=u.sort((function(e,t){return Date.parse(t.get("date"))-Date.parse(e.get("date"))})).map((function(e){return c.a.createElement(Ja,{review:e,key:e.get("id")})}))).filter((function(e,t){return!(t%2)})),r=t.filter((function(e,t){return t%2}))),c.a.createElement("div",{className:"movie-card__reviews movie-card__row"},t&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"movie-card__reviews-col"},a),c.a.createElement("div",{className:"movie-card__reviews-col"},r)),!t&&c.a.createElement("div",null,"No reviews yet. Your will be the first!")))})),Za=Object(n.memo)((function(e){var t=e.film,a=Object(n.useState)("Overview"),r=Object(Wt.a)(a,2),i=r[0],s=r[1];Object(n.useEffect)((function(){window.scrollTo(0,0)}),[t]),Object(n.useEffect)((function(){return function(){s("Overview")}}),[t]),function(e){var t=Object(l.useDispatch)(),a=Object(l.useSelector)(da);Object(n.useEffect)((function(){a&&a.get("id")===e.get("id")||t(me(e))}),[t,e,a])}(t);var o=aa(),u=o.isPlaying,m=o.handleExitBtnClick,E=o.playBtnClickHandler,_=o.videoRef,d=o.isVideoLoading,v=o.onCanPlayThroughHandler,f=Object(n.useCallback)((function(e){s(e)}),[]),p=t.get("poster_image"),b=t.get("name"),h=t.get("genre"),g=t.get("released"),S=t.get("run_time"),O=t.get("director"),T=t.get("starring"),F=["Overview","Details","Reviews"].map((function(e){var t=e===i,a=Ct()("movie-nav__item",{"movie-nav__item--active":t}),r=t?{cursor:"default"}:{};return c.a.createElement("li",{className:a,key:e},c.a.createElement("a",{className:"movie-nav__link",onClick:function(){return f(e)},title:t?"":e,style:r},e))}));return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"movie-card__hero"},c.a.createElement(Pt,{film:t}),c.a.createElement("div",{className:"movie-card__wrap"},c.a.createElement("div",{className:"movie-card__desc"},c.a.createElement("h2",{className:"movie-card__title"},b),c.a.createElement("p",{className:"movie-card__meta"},c.a.createElement("span",{className:"movie-card__genre"},h),c.a.createElement("span",{className:"movie-card__year"},g)),c.a.createElement("div",{className:"movie-card__buttons"},c.a.createElement(Oa,{playBtnClickHandler:E,detailed:!0}))))),c.a.createElement("div",{className:"movie-card__wrap movie-card__translate-top"},c.a.createElement("div",{className:"movie-card__info"},c.a.createElement("div",{className:"movie-card__poster movie-card__poster--big"},c.a.createElement("img",{src:p,alt:"".concat(b," poster"),width:"218",height:"327"})),c.a.createElement("div",{className:"movie-card__desc"},c.a.createElement("nav",{className:"movie-nav movie-card__nav"},c.a.createElement("ul",{className:"movie-nav__list"},F)),"Overview"===i&&c.a.createElement(Va,{rating:t.get("rating").toFixed(1),scoresCount:t.get("scores_count"),description:t.get("description"),director:O,starring:T}),"Details"===i&&c.a.createElement(Ma,{genre:h,released:g,runTime:S,director:O,starring:T}),"Reviews"===i&&c.a.createElement(za,{id:t.get("id")})),c.a.createElement(ta,{src:t.get("video_link"),posterImage:p,runTime:S,ref:_,handleExitBtnClick:m,onCanPlayThroughHandler:v,isVideoLoading:d,isPlaying:u}))))})),Ya=Object(n.memo)((function(e){var t=e.film,a=Object(l.useSelector)(function(e){return Object(ra.a)(ma,(function(t){if(Qt(t))return t.filter((function(t){return t.get("genre")===e.get("genre")&&t!==e})).slice(0,4)}))}(t)),r=a.map((function(e){return c.a.createElement(wa,{key:e.get("id"),film:e})}));return Qt(a)?c.a.createElement("section",{className:"catalog catalog--like-this"},c.a.createElement("h2",{className:"catalog__title"},"More like this"),c.a.createElement("div",{className:"catalog__movies-list"},r)):null})),Ka=function(){var e,t=Object(Tt.useParams)().id,a=Ca(),r=a.isFilmsFetching,n=a.filmsError,i=a.films;if(r)return c.a.createElement("div",{className:"movie-card__hero"},c.a.createElement(Pt,null),c.a.createElement(ea,null));if(n)return c.a.createElement("div",{className:"movie-card__hero"},c.a.createElement(Pt,null),c.a.createElement("div",null,"Error"));if(Qt(i)&&(e=i.find((function(e){return e.get("id")===+t}))),!e)return c.a.createElement(Tt.Redirect,{to:I.MAIN_PAGE});var s=e.get("background_color"),l={backgroundImage:"linear-gradient(-180deg, ".concat(s," 0%, ").concat(s," 100%)")},o={backgroundColor:s};return c.a.createElement(c.a.Fragment,null,c.a.createElement("section",{className:"movie-card movie-card--full",style:o},c.a.createElement(Za,{film:e})),c.a.createElement("div",{className:"page-content",style:l},c.a.createElement(Ya,{film:e}),c.a.createElement(Aa,null)))},Xa=Object(n.memo)((function(e){var t=e.value,a=e.groupValue,r=e.disabled,n=e.field,i=n.onChange,s=n.onBlur;return c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{className:"rating__input",id:"star-".concat(t),type:"radio",name:"rating",value:t,checked:t===+a,onChange:i,onBlur:s,disabled:r}),c.a.createElement("label",{className:"rating__label",htmlFor:"star-".concat(t)},"Rating-".concat(t)))})),$a=Object(n.memo)((function(e){var t=e.isReviewFetching,a=e.reviewFormSubmitHandler;return c.a.createElement(Ha.d,{initialValues:xa.initialValues,onSubmit:a,validationSchema:xa.schema},(function(e){var a=e.values,r=e.isValid;return c.a.createElement(Ha.c,{className:"add-review__form"},c.a.createElement(Ha.a,{name:"rating"},(function(e){return c.a.createElement("div",{className:"review__message"},e)})),c.a.createElement(Ha.a,{name:"review-text"},(function(e){return c.a.createElement("div",{className:"review__message"},e)})),c.a.createElement("div",{className:"rating"},c.a.createElement("div",{className:"rating__stars"},n.Children.toArray(new Array(5).fill("").map((function(e,r){return c.a.createElement(Ha.b,{component:Xa,value:5-r,groupValue:a.rating,disabled:t})}))))),c.a.createElement("div",{className:"add-review__text"},c.a.createElement(Ha.b,{className:"add-review__textarea",as:"textarea",name:"review-text",id:"review-text",placeholder:"Review text",disabled:t}),c.a.createElement("div",{className:"add-review__submit"},c.a.createElement("button",{className:"add-review__btn",type:"submit",title:"Post",disabled:!r||t},"Post"))))}))})),er=function(){var e=Object(Tt.useParams)().id,t=Object(l.useDispatch)(),a=function(){var e=Object(l.useDispatch)(),t=Object(n.useCallback)((function(t,a){e(Le(t,a))}),[e]),a=Object(l.useSelector)(qa);return{isReviewFetching:Object(l.useSelector)(Ba),reviewError:a,reviewFormSubmitHandler:t}}(),r=a.isReviewFetching,i=a.reviewError,s=a.reviewFormSubmitHandler,o=r;Object(n.useEffect)((function(){t(De())}),[t]);var u=Object(n.useCallback)((function(t){s(+e,t)}),[e,s]);return i?c.a.createElement("div",null,i.message):c.a.createElement(c.a.Fragment,null,c.a.createElement($a,{isReviewFetching:o,reviewFormSubmitHandler:u}),r&&c.a.createElement(Sa,null,"Sending your review... Please, wait"))},tr=function(){var e,t=Object(l.useSelector)(wt),a=Object(l.useSelector)(ma),r=Object(Tt.useParams)().id,n={};Qt(a)&&(n={backgroundColor:(e=a.find((function(e){return e.get("id")===+r}))).get("background_color")});return t?c.a.createElement("section",{className:"movie-card movie-card--full",style:n},c.a.createElement("div",{className:"movie-card__header"},c.a.createElement(Pt,{film:e})),c.a.createElement("div",{className:"add-review"},c.a.createElement(er,null)),c.a.createElement(Aa,null)):c.a.createElement(Tt.Redirect,{to:I.LOGIN_PAGE})},ar=function(){var e,t=function(){var e=Object(l.useDispatch)(),t=Object(l.useSelector)(ia);Object(n.useEffect)((function(){e(Xe())}),[e]);var a=Object(l.useSelector)(ca);return{isFavoritesFetching:Object(l.useSelector)(na),favoritesError:a,favorites:t}}(),a=t.isFavoritesFetching,r=t.favoritesError,i=t.favorites;return a?c.a.createElement(ea,null):r?c.a.createElement("div",null,"Error"):Qt(i)?(e=i,c.a.createElement(ja,{films:e})):c.a.createElement("div",null,"Your list of favorite films is empty!")},rr=function(){return Object(l.useSelector)(wt)?c.a.createElement("div",{className:"user-page"},c.a.createElement(Pt,null),c.a.createElement("section",{className:"catalog"},c.a.createElement("h2",{className:"catalog__title visually-hidden"},"Catalog"),c.a.createElement(ar,null)),c.a.createElement(Aa,null)):c.a.createElement(Tt.Redirect,{to:I.LOGIN_PAGE})},nr=function(){return function(){var e=Object(l.useDispatch)();Object(n.useEffect)((function(){e(Se())}),[e])}(),c.a.createElement(Tt.Switch,null,c.a.createElement(Tt.Route,{path:"".concat("/whattowatch").concat(I.MAIN_PAGE),component:Na,exact:!0}),c.a.createElement(Tt.Route,{path:"".concat("/whattowatch").concat(I.LOGIN_PAGE),component:La,exact:!0}),c.a.createElement(Tt.Route,{path:"".concat("/whattowatch").concat(I.FILM_PAGE),component:Ka,exact:!0}),c.a.createElement(Tt.Route,{path:"".concat("/whattowatch").concat(I.REVIEW_PAGE),component:tr,exact:!0}),c.a.createElement(Tt.Route,{path:"".concat("/whattowatch").concat(I.FAVORITES_PAGE),component:rr,exact:!0}),c.a.createElement(Tt.Redirect,{to:"".concat("/whattowatch").concat(I.MAIN_PAGE)}))};s.a.render(c.a.createElement(l.Provider,{store:gt},c.a.createElement(o.ConnectedRouter,{history:M},c.a.createElement(u.a,{persistor:St,loading:c.a.createElement(ea,null)},c.a.createElement(nr,null)))),document.querySelector("#root"))}},[[104,1,2]]]);
//# sourceMappingURL=main.478990b4.chunk.js.map