(this.webpackJsonpwhattowatch=this.webpackJsonpwhattowatch||[]).push([[0],{108:function(e,t,a){e.exports=a(137)},137:function(e,t,a){"use strict";a.r(t);var r,n=a(0),c=a.n(n),i=a(66),s=a.n(i),l=a(2),o=a(12),u=a(91),m=a(16),E=a(30),d=a(61),_=a(92),v=a.n(_),f=a(93),p=a.n(f),b=a(8);!function(e){e.FETCH_AUTH_REQUEST="FETCH_AUTH_REQUEST",e.FETCH_AUTH_SUCCESS="FETCH_AUTH_SUCCESS",e.FETCH_AUTH_FAIL="FETCH_AUTH_FAIL",e.FETCH_AUTH_STATUS_REQUEST="FETCH_AUTH_STATUS_REQUEST",e.FETCH_AUTH_STATUS_SUCCESS="FETCH_AUTH_STATUS_SUCCESS",e.FETCH_AUTH_STATUS_FAIL="FETCH_AUTH_STATUS_FAIL",e.AUTH_STATUS_UNAUTHORIZED="AUTH_STATUS_UNAUTHORIZED",e.RESET_AUTH_ERROR="RESET_AUTH_ERROR"}(r||(r={}));var h,g=Object(b.Map)({user:null,authError:null,isAuthFetching:!1,authStatusError:null,isAuthStatusFetching:!1}),S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.FETCH_AUTH_REQUEST:return e.set("authError",null).set("isAuthFetching",!0);case r.FETCH_AUTH_SUCCESS:return e.set("user",Object(b.Map)(t.payload)).set("isAuthFetching",!1);case r.FETCH_AUTH_FAIL:return e.set("user",null).set("isAuthFetching",!1).set("authError",t.payload);case r.FETCH_AUTH_STATUS_REQUEST:return e.set("authStatusError",null).set("isAuthStatusFetching",!0);case r.FETCH_AUTH_STATUS_SUCCESS:return e.set("user",Object(b.Map)(t.payload)).set("isAuthStatusFetching",!1);case r.FETCH_AUTH_STATUS_FAIL:return e.set("user",null).set("isAuthStatusFetching",!1).set("authStatusError",t.payload);case r.AUTH_STATUS_UNAUTHORIZED:return e.set("user",null).set("isAuthStatusFetching",!1);case r.RESET_AUTH_ERROR:return e.set("authError",null);default:}return e};!function(e){e.FETCH_PROMO_REQUEST="FETCH_PROMO_REQUEST",e.FETCH_PROMO_SUCCESS="FETCH_PROMO_SUCCESS",e.FETCH_PROMO_FAIL="FETCH_PROMO_FAIL"}(h||(h={}));var O,T={promo:Object(b.Map)(),isPromoFetching:!0,promoError:null},F=Object(b.Map)(T),w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.FETCH_PROMO_REQUEST:return e.set("promoError",null).set("isPromoFetching",!0);case h.FETCH_PROMO_SUCCESS:return e.set("promo",Object(b.fromJS)(t.payload)).set("isPromoFetching",!1);case h.FETCH_PROMO_FAIL:return e.set("promo",Object(b.Map)()).set("isPromoFetching",!1).set("promoError",t.payload);default:}return e};!function(e){e.FETCH_FILMS_REQUEST="FETCH_FILMS_REQUEST",e.FETCH_FILMS_SUCCESS="FETCH_FILMS_SUCCESS",e.FETCH_FILMS_FAIL="FETCH_FILMS_FAIL",e.SET_FILTER="SET_FILTER",e.SET_FILM="SET_FILM"}(O||(O={}));var C,j={films:Object(b.List)(),isFilmsFetching:!0,filmsError:null,filter:"All genres",film:null},y=Object(b.Map)(j),R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O.FETCH_FILMS_REQUEST:return e.set("filmsError",null).set("isFilmsFetching",!0);case O.FETCH_FILMS_SUCCESS:return e.set("films",Object(b.fromJS)(t.payload)).set("isFilmsFetching",!1);case O.FETCH_FILMS_FAIL:return e.set("films",Object(b.List)()).set("isFilmsFetching",!1).set("filmsError",t.payload);case O.SET_FILTER:return e.set("filter",t.payload);case O.SET_FILM:return e.set("film",t.payload);default:}return e};!function(e){e.FETCH_REVIEWS_REQUEST="FETCH_REVIEWS_REQUEST",e.FETCH_REVIEWS_SUCCESS="FETCH_REVIEWS_SUCCESS",e.FETCH_REVIEWS_FAIL="FETCH_REVIEWS_FAIL",e.FETCH_REVIEW_REQUEST="FETCH_REVIEW_REQUEST",e.FETCH_REVIEW_SUCCESS="FETCH_REVIEW_SUCCESS",e.FETCH_REVIEW_FAIL="FETCH_REVIEW_FAIL",e.RESET_REVIEW_ERROR="RESET_REVIEW_ERROR"}(C||(C={}));var A,N={reviews:Object(b.fromJS)({id:null,data:Object(b.List)()}),isReviewsFetching:!0,reviewsError:null,isReviewFetching:!1,reviewError:null},H=Object(b.Map)(N),U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C.FETCH_REVIEWS_REQUEST:return e.set("reviewsError",null).set("isReviewsFetching",!0);case C.FETCH_REVIEWS_SUCCESS:return e.set("reviews",Object(b.fromJS)(t.payload)).set("isReviewsFetching",!1);case C.FETCH_REVIEWS_FAIL:return e.set("reviews",Object(b.fromJS)({id:null,data:Object(b.List)()})).set("isReviewsFetching",!1).set("reviewsError",t.payload);case C.FETCH_REVIEW_REQUEST:return e.set("reviewError",null).set("isReviewFetching",!0);case C.FETCH_REVIEW_SUCCESS:return e.set("reviews",Object(b.fromJS)(t.payload)).set("isReviewFetching",!1).set("isReviewsFetching",!1);case C.FETCH_REVIEW_FAIL:return e.set("isReviewFetching",!1).set("isReviewsFetching",!1).set("reviewError",t.payload);case C.RESET_REVIEW_ERROR:return e.set("reviewError",null);default:}return e};!function(e){e.FETCH_FAVORITES_REQUEST="FETCH_FAVORITES_REQUEST",e.FETCH_FAVORITES_SUCCESS="FETCH_FAVORITES_SUCCESS",e.FETCH_FAVORITES_FAIL="FETCH_FAVORITES_FAIL",e.FETCH_FAVORITE_REQUEST="FETCH_FAVORITE_REQUEST",e.FETCH_FAVORITE_SUCCESS="FETCH_FAVORITE_SUCCESS",e.FETCH_FAVORITE_FAIL="FETCH_FAVORITE_FAIL",e.RESET_FAVORITE_ERROR="RESET_FAVORITE_ERROR"}(A||(A={}));var x,I,k={favorites:Object(b.List)(),isFavoritesFetching:!0,favoritesError:null,isFavoriteFetching:!1,favoriteError:null},P=Object(b.Map)(k),L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A.FETCH_FAVORITES_REQUEST:return e.set("favoritesError",null).set("isFavoritesFetching",!0);case A.FETCH_FAVORITES_SUCCESS:var a=Array.isArray(t.payload)?t.payload:[t.payload];return e.set("favorites",Object(b.fromJS)(a)).set("isFavoritesFetching",!1);case A.FETCH_FAVORITES_FAIL:return e.set("favorites",Object(b.List)()).set("isFavoritesFetching",!1).set("favoritesError",t.payload);case A.FETCH_FAVORITE_REQUEST:return e.set("favoriteError",null).set("isFavoriteFetching",!0);case A.FETCH_FAVORITE_SUCCESS:return e.set("isFavoriteFetching",!1);case A.FETCH_FAVORITE_FAIL:return e.set("isFavoriteFetching",!1).set("favoriteError",t.payload);case A.RESET_FAVORITE_ERROR:return e.set("favoriteError",null);default:}return e},V={transforms:[p()()],key:"root",storage:v.a},M=Object(E.a)(),D=Object(o.connectRouter)(M),W=Object(m.combineReducers)({router:D,auth:S,promo:w,films:R,reviews:U,favorites:L}),Q=Object(d.persistReducer)(V,W),G=a(94),B=a(95),q=a(106),J=a(4),z=a.n(J),Z=a(3),Y=function(){return{type:h.FETCH_PROMO_REQUEST}},K=function(e){return{type:h.FETCH_PROMO_SUCCESS,payload:e}},X=function(e){return{type:h.FETCH_PROMO_FAIL,error:!0,payload:e}},$="https://htmlacademy-react-3.appspot.com/wtw",ee={promo:{fetchPromo:function(){return fetch("".concat($,"/films/promo"))}},films:{fetchFilms:function(){return fetch("".concat($,"/films"))}},auth:{fetchAuth:function(e){return fetch("".concat($,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),credentials:"include"})},fetchAuthStatus:function(){return fetch("".concat($,"/login"),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"})}},reviews:{fetchReviews:function(e){return fetch("".concat($,"/comments/").concat(e))},fetchReview:function(e,t){return fetch("".concat($,"/comments/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:t.rating,comment:t["review-text"]}),credentials:"include"})}},favorites:{fetchFavorites:function(){return fetch("".concat($,"/favorite"),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"})},fetchFavorite:function(e,t){return fetch("".concat($,"/favorite/").concat(e,"/").concat(t),{method:"POST",credentials:"include"})}}};!function(e){e.MAIN_PAGE="/",e.LOGIN_PAGE="/login",e.FILM_PAGE="/film/:id",e.REVIEW_PAGE="/film/:id/review",e.FAVORITES_PAGE="/mylist"}(x||(x={})),function(e){e[e.SUCCESS_STATUS_CODE=200]="SUCCESS_STATUS_CODE",e[e.NOT_FOUND_STATUS_CODE=404]="NOT_FOUND_STATUS_CODE",e[e.UNAUTHORIZED_STATUS_CODE=401]="UNAUTHORIZED_STATUS_CODE"}(I||(I={}));var te=z.a.mark(ae);function ae(){var e,t;return z.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Z.b)(ee.promo.fetchPromo);case 3:if((e=a.sent).status===I.SUCCESS_STATUS_CODE){a.next=6;break}throw new Error("We are sorry. Promo film can't be loaded now. Please, reload the page.");case 6:return a.next=8,Object(Z.b)([e,e.json]);case 8:return t=a.sent,a.next=11,Object(Z.c)(K(t));case 11:a.next=17;break;case 13:return a.prev=13,a.t0=a.catch(0),a.next=17,Object(Z.c)(X(a.t0));case 17:case"end":return a.stop()}}),te,null,[[0,13]])}var re=z.a.mark(ce),ne=z.a.mark(ie);function ce(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(h.FETCH_PROMO_REQUEST,ae);case 2:case"end":return e.stop()}}),re)}function ie(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)([Object(Z.b)(ce)]);case 2:case"end":return e.stop()}}),ne)}var se=function(){return{type:O.FETCH_FILMS_REQUEST}},le=function(e){return{type:O.FETCH_FILMS_SUCCESS,payload:e}},oe=function(e){return{type:O.FETCH_FILMS_FAIL,error:!0,payload:e}},ue=function(e){return{type:O.SET_FILTER,payload:e}},me=function(e){return{type:O.SET_FILM,payload:e}},Ee=z.a.mark(de);function de(){var e,t;return z.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Z.b)(ee.films.fetchFilms);case 3:if((e=a.sent).status===I.SUCCESS_STATUS_CODE){a.next=6;break}throw new Error("We are sorry. List of films can't be loaded now. Please, reload the page.");case 6:return a.next=8,Object(Z.b)([e,e.json]);case 8:return t=a.sent,a.next=11,Object(Z.c)(le(t));case 11:a.next=17;break;case 13:return a.prev=13,a.t0=a.catch(0),a.next=17,Object(Z.c)(oe(a.t0));case 17:case"end":return a.stop()}}),Ee,null,[[0,13]])}var _e=z.a.mark(fe),ve=z.a.mark(pe);function fe(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(O.FETCH_FILMS_REQUEST,de);case 2:case"end":return e.stop()}}),_e)}function pe(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)([Object(Z.b)(fe)]);case 2:case"end":return e.stop()}}),ve)}var be=function(e){return{type:r.FETCH_AUTH_REQUEST,payload:e}},he=function(e){return{type:r.FETCH_AUTH_SUCCESS,payload:e}},ge=function(e){return{type:r.FETCH_AUTH_FAIL,error:!0,payload:e}},Se=function(){return{type:r.FETCH_AUTH_STATUS_REQUEST}},Oe=function(e){return{type:r.FETCH_AUTH_STATUS_SUCCESS,payload:e}},Te=function(e){return{type:r.FETCH_AUTH_STATUS_FAIL,error:!0,payload:e}},Fe=function(){return{type:r.AUTH_STATUS_UNAUTHORIZED}},we=function(){return{type:r.RESET_AUTH_ERROR}},Ce=z.a.mark(je);function je(e){var t,a;return z.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(Z.b)(ee.auth.fetchAuth,e.payload);case 3:if((t=r.sent).status===I.SUCCESS_STATUS_CODE){r.next=6;break}throw new Error("We are sorry. You can't be signed in now. Please, reload the page and retry.");case 6:return r.next=8,Object(Z.b)([t,t.json]);case 8:return a=r.sent,r.next=11,Object(Z.c)(he(a));case 11:r.next=17;break;case 13:return r.prev=13,r.t0=r.catch(0),r.next=17,Object(Z.c)(ge(r.t0));case 17:case"end":return r.stop()}}),Ce,null,[[0,13]])}var ye=z.a.mark(Re);function Re(){var e,t;return z.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Z.b)(ee.auth.fetchAuthStatus);case 3:if((e=a.sent).status!==I.SUCCESS_STATUS_CODE){a.next=12;break}return a.next=7,Object(Z.b)([e,e.json]);case 7:return t=a.sent,a.next=10,Object(Z.c)(Oe(t));case 10:a.next=18;break;case 12:if(e.status!==I.UNAUTHORIZED_STATUS_CODE){a.next=17;break}return a.next=15,Object(Z.c)(Fe());case 15:a.next=18;break;case 17:throw new Error("Authorization failed. Please, reload the page.");case 18:a.next=24;break;case 20:return a.prev=20,a.t0=a.catch(0),a.next=24,Object(Z.c)(Te(a.t0));case 24:case"end":return a.stop()}}),ye,null,[[0,20]])}var Ae=z.a.mark(Ue),Ne=z.a.mark(xe),He=z.a.mark(Ie);function Ue(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(r.FETCH_AUTH_REQUEST,je);case 2:case"end":return e.stop()}}),Ae)}function xe(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(r.FETCH_AUTH_STATUS_REQUEST,Re);case 2:case"end":return e.stop()}}),Ne)}function Ie(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)([Object(Z.b)(Ue),Object(Z.b)(xe)]);case 2:case"end":return e.stop()}}),He)}var ke=function(e){return{type:C.FETCH_REVIEWS_REQUEST,payload:e}},Pe=function(e,t){return{type:C.FETCH_REVIEWS_SUCCESS,payload:{id:e,data:t}}},Le=function(e){return{type:C.FETCH_REVIEWS_FAIL,error:!0,payload:e}},Ve=function(e,t){return{type:C.FETCH_REVIEW_REQUEST,payload:{id:e,reviewData:t}}},Me=function(e,t){return{type:C.FETCH_REVIEW_SUCCESS,payload:{id:e,data:t}}},De=function(e){return{type:C.FETCH_REVIEW_FAIL,error:!0,payload:e}},We=function(){return{type:C.RESET_REVIEW_ERROR}},Qe=z.a.mark(Ge);function Ge(e){var t,a;return z.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(Z.b)(ee.reviews.fetchReviews,e.payload);case 3:if((t=r.sent).status===I.SUCCESS_STATUS_CODE){r.next=6;break}throw new Error("We are sorry. List of reviews can't be loaded now. Please, reload the page.");case 6:return r.next=8,Object(Z.b)([t,t.json]);case 8:return a=r.sent,r.next=11,Object(Z.c)(Pe(e.payload,a));case 11:r.next=17;break;case 13:return r.prev=13,r.t0=r.catch(0),r.next=17,Object(Z.c)(Le(r.t0));case 17:case"end":return r.stop()}}),Qe,null,[[0,13]])}var Be=z.a.mark(qe);function qe(e){var t,a,r,n,c;return z.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,t=e.payload,a=t.id,r=t.reviewData,i.next=4,Object(Z.b)(ee.reviews.fetchReview,a,r);case 4:if((n=i.sent).status!==I.SUCCESS_STATUS_CODE){i.next=15;break}return i.next=8,Object(Z.b)([n,n.json]);case 8:return c=i.sent,i.next=11,Object(Z.c)(Me(a,c));case 11:return i.next=13,Object(Z.c)(Object(o.push)("".concat("/whattowatch","/film/").concat(a)));case 13:i.next=20;break;case 15:if(n.status!==I.UNAUTHORIZED_STATUS_CODE){i.next=19;break}throw new Error("You're unauthorized. Please, sign in and retry.");case 19:throw new Error("Can't save your review. Please, reload the page and retry.");case 20:i.next=26;break;case 22:return i.prev=22,i.t0=i.catch(0),i.next=26,Object(Z.c)(De(i.t0));case 26:case"end":return i.stop()}}),Be,null,[[0,22]])}var Je=z.a.mark(Ye),ze=z.a.mark(Ke),Ze=z.a.mark(Xe);function Ye(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(C.FETCH_REVIEWS_REQUEST,Ge);case 2:case"end":return e.stop()}}),Je)}function Ke(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(C.FETCH_REVIEW_REQUEST,qe);case 2:case"end":return e.stop()}}),ze)}function Xe(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)([Object(Z.b)(Ye),Object(Z.b)(Ke)]);case 2:case"end":return e.stop()}}),Ze)}var $e=function(){return{type:A.FETCH_FAVORITES_REQUEST}},et=function(e){return{type:A.FETCH_FAVORITES_SUCCESS,payload:e}},tt=function(e){return{type:A.FETCH_FAVORITES_FAIL,error:!0,payload:e}},at=function(e,t){return{type:A.FETCH_FAVORITE_REQUEST,payload:{id:e,status:t}}},rt=function(e){return{type:A.FETCH_FAVORITE_SUCCESS,payload:e}},nt=function(e){return{type:A.FETCH_FAVORITE_FAIL,error:!0,payload:e}},ct=function(){return{type:A.RESET_FAVORITE_ERROR}},it=z.a.mark(st);function st(){var e,t;return z.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(Z.b)(ee.favorites.fetchFavorites);case 3:if((e=a.sent).status===I.SUCCESS_STATUS_CODE){a.next=6;break}throw new Error("We are sorry. List of films can't be loaded now. Please, reload the page.");case 6:return a.next=8,Object(Z.b)([e,e.json]);case 8:return t=a.sent,a.next=11,Object(Z.c)(et(t));case 11:a.next=17;break;case 13:return a.prev=13,a.t0=a.catch(0),a.next=17,Object(Z.c)(tt(a.t0));case 17:case"end":return a.stop()}}),it,null,[[0,13]])}var lt=z.a.mark(ot);function ot(e){var t,a,r,n,c;return z.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,t=e.payload,a=t.id,r=t.status,i.next=4,Object(Z.b)(ee.favorites.fetchFavorite,a,r);case 4:if((n=i.sent).status!==I.SUCCESS_STATUS_CODE){i.next=15;break}return i.next=8,Object(Z.b)([n,n.json]);case 8:return c=i.sent,i.next=11,Object(Z.c)(rt(c));case 11:return i.next=13,Object(Z.c)($e());case 13:i.next=20;break;case 15:if(n.status!==I.UNAUTHORIZED_STATUS_CODE){i.next=19;break}throw new Error("You're unauthorized. Please, sign in and retry.");case 19:throw new Error("We are sorry. The film can't be marked as favorite. Please, reload the page and retry.");case 20:i.next=26;break;case 22:return i.prev=22,i.t0=i.catch(0),i.next=26,Object(Z.c)(nt(i.t0));case 26:case"end":return i.stop()}}),lt,null,[[0,22]])}var ut=z.a.mark(dt),mt=z.a.mark(_t),Et=z.a.mark(vt);function dt(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(A.FETCH_FAVORITES_REQUEST,st);case 2:case"end":return e.stop()}}),ut)}function _t(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.d)(A.FETCH_FAVORITE_REQUEST,ot);case 2:case"end":return e.stop()}}),mt)}function vt(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)([Object(Z.b)(dt),Object(Z.b)(_t)]);case 2:case"end":return e.stop()}}),Et)}var ft=z.a.mark(pt);function pt(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.a)([Object(Z.b)(ie),Object(Z.b)(pe),Object(Z.b)(Ie),Object(Z.b)(Xe),Object(Z.b)(vt)]);case 2:case"end":return e.stop()}}),ft)}var bt=Object(o.routerMiddleware)(M),ht=Object(q.a)(),gt=[ht,bt];Object(G.createLogger)({duration:!0,collapsed:!0,colors:{title:function(e){return e.error?"firebrick":"deepskyblue"},prevState:function(){return"#1C5FAF"},action:function(){return"#149945"},nextState:function(){return"#A47104"},error:function(){return"#ff0005"}}});var St=Object(m.createStore)(Q,Object(B.composeWithDevTools)(m.applyMiddleware.apply(void 0,gt))),Ot=Object(d.persistStore)(St);ht.run(pt);var Tt,Ft=a(88),wt=a(36),Ct=a.n(wt),jt=function(e){return e.auth.get("user")},yt=function(e){return e.auth.get("authError")},Rt=function(e){return e.auth.get("isAuthFetching")},At=function(e){return e.auth.get("authStatusError")},Nt=function(e){return e.auth.get("isAuthStatusFetching")},Ht=function(e){return e.promo.get("isPromoFetching")},Ut=function(e){return e.promo.get("promoError")},xt=function(e){return e.promo.get("promo")},It=function(){var e=Object(Ft.useLocation)().pathname==="".concat("/whattowatch").concat(x.MAIN_PAGE),t=Object(l.useDispatch)();return Object(n.useCallback)((function(){e||t(Object(o.push)("".concat("/whattowatch").concat(x.MAIN_PAGE)))}),[e,t])},kt=function(e){var t=e.isMainPage,a=e.logoLinkClickHandler,r=e.isFooter,n=t?{}:{cursor:"pointer"},i=Ct()("logo__link",{"logo__link--light":r});return c.a.createElement("div",{className:"logo"},c.a.createElement("a",{className:i,onClick:a,style:n,title:t?"":"To the main page"},c.a.createElement("span",{className:"logo__letter logo__letter--1"},"W"),c.a.createElement("span",{className:"logo__letter logo__letter--2"},"T"),c.a.createElement("span",{className:"logo__letter logo__letter--3"},"W")))},Pt=function(e){var t=Object(l.useDispatch)();return Object(n.useCallback)((function(){t(Object(o.push)("".concat("/whattowatch","/film/").concat(e)))}),[t,e])},Lt=function(e){var t,a,r,i,s=e.film,u=Object(l.useSelector)(jt),m=Object(l.useSelector)(xt),E=Object(l.useSelector)(At),d=Object(l.useSelector)(Nt),_=Object(l.useDispatch)();s?(t=s.get("background_image"),a=s.get("name"),r=s.get("poster_image"),i=s.get("id")):(t=m.get("background_image"),a=m.get("name"));var v,f=Object(Ft.useLocation)().pathname,p=f.includes("film")&&!f.includes("review"),b=f==="".concat("/whattowatch").concat(x.MAIN_PAGE),h=f.includes("review"),g=f==="".concat("/whattowatch").concat(x.FAVORITES_PAGE),S=It(),O=function(){var e=Object(Ft.useLocation)().pathname==="".concat("/whattowatch").concat(x.LOGIN_PAGE),t=Object(l.useDispatch)();return{signInLinkClickHandler:Object(n.useCallback)((function(){e||t(Object(o.push)("".concat("/whattowatch").concat(x.LOGIN_PAGE)))}),[e,t]),isLoginPage:e}}(),T=O.signInLinkClickHandler,F=O.isLoginPage,w=Pt(i),C=Object(n.useCallback)((function(){g||_(Object(o.push)("".concat("/whattowatch").concat(x.FAVORITES_PAGE)))}),[_,g]),j=c.a.createElement("div",{className:"user-block"},c.a.createElement("a",{className:"user-block__link",onClick:T,title:"To the login page"},"Sign in"));if(d)j=c.a.createElement("div",{className:"user-block"},"Authorization...");else if(E)j=c.a.createElement("div",{className:"user-block"},E.message);else if(u){v=u.get("avatar_url");var y=g?{cursor:"default"}:{};j=c.a.createElement("div",{className:"user-block"},c.a.createElement("div",{className:"user-block__avatar"},c.a.createElement("img",{src:"https://htmlacademy-react-3.appspot.com/".concat(v),onClick:C,height:"63",alt:"User avatar",width:"63",title:g?"":"To the favorites page",style:y})))}var R=Ct()("page-header",{"user-page__head":F||g,"movie-card__head":p});return c.a.createElement(c.a.Fragment,null,!F&&!g&&c.a.createElement("div",{className:"movie-card__bg"},c.a.createElement("img",{src:t,alt:a})),c.a.createElement("h1",{className:"visually-hidden"},"WTW"),c.a.createElement("header",{className:R},c.a.createElement(kt,{isMainPage:b,logoLinkClickHandler:S}),h&&c.a.createElement("nav",{className:"breadcrumbs"},c.a.createElement("ul",{className:"breadcrumbs__list"},c.a.createElement("li",{className:"breadcrumbs__item"},c.a.createElement("a",{className:"breadcrumbs__link breadcrumbs__link--active",onClick:w,title:"To the film page"},a)),c.a.createElement("li",{className:"breadcrumbs__item"},c.a.createElement("a",{className:"breadcrumbs__link"},"Add review")))),(F||g)&&c.a.createElement("h1",{className:"page-title  user-page__title"},F?"Sign in":"My list"),!F&&j),h&&c.a.createElement("div",{className:"movie-card__poster movie-card__poster--small"},c.a.createElement("img",{src:r,alt:a,width:"218",height:"327"})))},Vt=a(96),Mt=a.n(Vt),Dt=function(e){var t=e?e/60|0:0,a=e?e%60|0:0;return Mt.a.utc().hours(t).minutes(a).seconds(0).format("h:mm:ss")},Wt=function(e){return null!==e.current},Qt=function(e){return 0!==e.size},Gt=a(23),Bt=a(31),qt=a(32);function Jt(){var e=Object(Bt.a)(["\n    left: 153px;\n    top: 78px;\n    position: absolute;\n    animation: "," linear 1s infinite;\n    background: #831a19;\n    width: 19px;\n    height: 39px;\n    border-radius: 9px / 19px;\n    transform-origin: 9px 85px;\n    box-sizing: content-box;\n    transform: ",";\n    animation-delay: ",";\n"]);return Jt=function(){return e},e}function zt(){var e=Object(Bt.a)(["\n    width: 327px;\n    height: 327px;\n    display: block;\n    overflow: hidden;\n    background: transparent;\n    margin: 0 auto;\n    position: relative;\n    transform: translateZ(0) scale(1);\n    backface-visibility: hidden;\n    transform-origin: 0 0;\n"]);return zt=function(){return e},e}function Zt(){var e=Object(Bt.a)(["\n    0% {\n        opacity: 1\n    }\n\n    100% {\n        opacity: 0\n    }\n"]);return Zt=function(){return e},e}var Yt=Object(qt.b)(Zt()),Kt=qt.a.div(zt()),Xt=qt.a.div(Jt(),Yt,(function(e){return e.rotate}),(function(e){return e.delay})),$t=[0,30,60,90,120,150,180,210,240,270,300,330],ea=[-.9166666666666666,-.8333333333333334,-.75,-.6666666666666666,-.583333333333333,-.5,-.4166666666666667,-.3333333333333333,-.25,-.16666666666666666,-.08333333333333333,0],ta=function(){return c.a.createElement(Kt,null,n.Children.toArray(new Array(12).fill("").map((function(e,t){return c.a.createElement(Xt,{rotate:"rotate(".concat($t[t],"deg)"),delay:"".concat(ea[t],"s")})}))))},aa=Object(n.memo)(Object(n.forwardRef)((function(e,t){var a=e.handleExitBtnClick,r=e.src,i=e.posterImage,s=e.runTime,l=e.isPlaying,o=e.isVideoLoading,u=e.onCanPlayThroughHandler,m=function(e){var t=Object(n.useState)(0),a=Object(Gt.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){return Wt(e)&&e&&(Tt=setInterval((function(){c(e.current.currentTime/e.current.duration*100)}),1e3)),function(){return clearInterval(Tt)}}),[e]),isFinite(r)?r:0}(t),E=function(e,t,a){var r=Object(n.useState)(!1),c=Object(Gt.a)(r,2),i=c[0],s=c[1];Object(n.useEffect)((function(){s(e)}),[e]);var l=Object(n.useCallback)((function(){Wt(t)&&(i?t.current.pause():t.current.play()),s((function(e){return!e}))}),[i,t]),o=Object(n.useCallback)((function(){Wt(t)&&(a(),t.current.currentTime=0,i&&t.current.pause())}),[a,t,i]);return{isActive:i,playPauseBtnHandler:l,exitBtnClickHandler:o}}(l,t,a),d=E.isActive,_=E.playPauseBtnHandler,v=E.exitBtnClickHandler,f=l?{}:{display:"none"},p=Object(n.useMemo)((function(){return Dt(s*(100-m))}),[s,m]);return o?c.a.createElement("div",{className:"player",style:f},c.a.createElement(ta,null),c.a.createElement("video",{className:"player__video",src:r,ref:t,onCanPlayThrough:u})):c.a.createElement("div",{className:"player",style:f},c.a.createElement("video",{className:"player__video",src:r,poster:i,ref:t}),c.a.createElement("button",{type:"button",className:"player__exit",onClick:v,title:"Exit"},"Exit"),c.a.createElement("div",{className:"player__controls"},c.a.createElement("div",{className:"player__controls-row"},c.a.createElement("div",{className:"player__time"},c.a.createElement("progress",{className:"player__progress",value:m,max:"100"}),c.a.createElement("div",{className:"player__toggler",style:{left:"".concat(m,"%")}},"Toggler")),c.a.createElement("div",{className:"player__time-value"},p)),c.a.createElement("div",{className:"player__controls-row"},c.a.createElement("button",{type:"button",className:"player__play",onClick:_,title:d?"Pause":"Play"},c.a.createElement("svg",{viewBox:d?"0 0 14 21":"0 0 320.001 320.001",width:"14",height:"21"},c.a.createElement("use",{xlinkHref:d?"#pause":"#play"})),c.a.createElement("span",null,d?"Pause":"Play")),c.a.createElement("div",{className:"player__name"},"Transpotting"),c.a.createElement("button",{type:"button",className:"player__full-screen",onClick:function(){Wt(t)&&t.current.requestFullscreen()},title:"Full screen"},c.a.createElement("svg",{viewBox:"0 0 27 27",width:"27",height:"27"},c.a.createElement("use",{xlinkHref:"#full-screen"})),c.a.createElement("span",null,"Full screen")))))}))),ra=function(){var e=Object(n.useState)(!1),t=Object(Gt.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(!0),i=Object(Gt.a)(c,2),s=i[0],l=i[1],o=Object(n.useRef)(null),u=Object(n.useCallback)((function(){o&&o.current&&(o.current.play(),r(!0),document.body.style.overflow="hidden")}),[]),m=Object(n.useCallback)((function(){r(!1),document.body.style.overflow="visible"}),[]),E=Object(n.useCallback)((function(){l(!1)}),[]);return{videoRef:o,isPlaying:a,handleExitBtnClick:m,playBtnClickHandler:u,isVideoLoading:s,onCanPlayThroughHandler:E}},na=a(59),ca=function(e){return e.favorites.get("isFavoritesFetching")},ia=function(e){return e.favorites.get("favoritesError")},sa=function(e){return e.favorites.get("favorites")},la=function(e){return e.favorites.get("isFavoriteFetching")},oa=function(e){return e.favorites.get("favoriteError")},ua=function(e){return e.films.get("isFilmsFetching")},ma=function(e){return e.films.get("filmsError")},Ea=function(e){return e.films.get("films")},da=Object(na.a)(Ea,(function(e){if(Qt(e)){var t=e.map((function(e){return e.get("genre")})).toSet().slice(0,9).sort();return Object(b.Set)(["All genres"]).concat(t)}})),_a=function(e){return e.films.get("filter")},va=function(e){return e.films.get("film")},fa=Object(na.a)(Ea,_a,(function(e,t){if(Qt(e))return"All genres"===t?e:e.filter((function(e){return e.get("genre")===t}))})),pa=function(e){var t,a=Object(l.useDispatch)(),r=Object(l.useSelector)(Ea);if("number"===typeof e)t=e;else if(Qt(r)){var c=r.find((function(t){return t.get("name")===e.get("name")}));t=c.get("id")}var i=Object(l.useSelector)(function(e){return Object(na.a)(sa,(function(t){return!!Qt(t)&&t.find((function(t){return t.get("id")===e}))}))}(t)),s=i?0:1,o=Object(n.useCallback)((function(){a(at(t,s))}),[a,s,t]),u=Object(l.useSelector)(oa);return{isFavoriteFetching:Object(l.useSelector)(la),favoriteError:u,myListBtnClickHandler:o,isFavorite:i}};function ba(){var e=Object(Bt.a)(["\n    position: fixed;\n    right: 0;\n    bottom: 0;\n    min-height: 50px;\n    width: 300px;\n    outline: 1px solid red;\n    padding: 10px 20px;\n    background-color: black;\n    opacity: 0;\n    animation: "," linear 5s;\n    text-align: center;\n"]);return ba=function(){return e},e}function ha(){var e=Object(Bt.a)(["\n    0% {\n        opacity: 0;\n    }\n\n    50% {\n        opacity: 1;\n    }\n\n    100% {\n        opacity: 0;\n    }\n"]);return ha=function(){return e},e}var ga=Object(qt.b)(ha()),Sa=qt.a.div(ba(),ga),Oa=Object(n.memo)((function(e){var t=e.children;return c.a.createElement(Sa,null,t)})),Ta=Object(n.memo)((function(e){var t=e.playBtnClickHandler,a=e.detailed,r=Object(Ft.useParams)().id,i=Object(l.useDispatch)(),s=Object(l.useSelector)(xt),u=Object(l.useSelector)(jt);Object(n.useEffect)((function(){i(ct())}),[i]);var m,E=Object(n.useCallback)((function(){i(Object(o.push)("".concat("/whattowatch","/film/").concat(r,"/review")))}),[i,r]);m=!r&&function(e){return 0!==e.size}(s)?s:+r;var d=pa(m),_=d.myListBtnClickHandler,v=d.isFavorite,f=d.isFavoriteFetching,p=d.favoriteError;return c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{className:"btn btn--play movie-card__button",type:"button",title:"Play",onClick:t},c.a.createElement("svg",{viewBox:"0 0 19 19",width:"19",height:"19"},c.a.createElement("use",{xlinkHref:"#play"})),c.a.createElement("span",null,"Play")),c.a.createElement("button",{className:"btn btn--list movie-card__button",type:"button",title:"My list",onClick:_},c.a.createElement("svg",{viewBox:"0 0 19 20",width:"19",height:"20"},c.a.createElement("use",{xlinkHref:v&&u?"#in-list":"#add"})),c.a.createElement("span",null,"My list")),a&&c.a.createElement("a",{className:"btn btn--add-review movie-card__button",title:"Add review",onClick:E},"Add review"),f&&c.a.createElement(Oa,null,"Saving to the favorites list... Please, wait."),p&&c.a.createElement(Oa,null,p.message))})),Fa=Object(n.memo)((function(e){var t=e.promo,a=ra(),r=a.isPlaying,n=a.handleExitBtnClick,i=a.playBtnClickHandler,s=a.videoRef,l=a.isVideoLoading,o=a.onCanPlayThroughHandler,u=t.get("name");return c.a.createElement("div",{className:"movie-card__wrap"},c.a.createElement("div",{className:"movie-card__info"},c.a.createElement("div",{className:"movie-card__poster"},c.a.createElement("img",{src:t.get("preview_image"),alt:"".concat(u," poster"),width:"218",height:"327"})),c.a.createElement("div",{className:"movie-card__desc"},c.a.createElement("h2",{className:"movie-card__title"},u),c.a.createElement("p",{className:"movie-card__meta"},c.a.createElement("span",{className:"movie-card__genre"},t.get("genre")),c.a.createElement("span",{className:"movie-card__year"},t.get("released"))),c.a.createElement("div",{className:"movie-card__buttons"},c.a.createElement(Ta,{playBtnClickHandler:i}))),c.a.createElement(aa,{src:t.get("video_link"),posterImage:t.get("poster_image"),runTime:t.get("run_time"),ref:s,isPlaying:r,handleExitBtnClick:n,isVideoLoading:l,onCanPlayThroughHandler:o})))}));function wa(){var e=Object(Bt.a)(["\n    min-height: 330px;\n    padding-top: 180px;\n    padding-left: 50px;\n    padding-right: 50px;\n    text-align: center;\n    font-size: 32px;\n    width: 1140px;\n    margin: 0 auto;\n    line-height: 40px;\n"]);return wa=function(){return e},e}var Ca=qt.a.div(wa()),ja=function(e){var t=e.children;return c.a.createElement(Ca,null,t)},ya=function(){var e=function(){var e=Object(l.useDispatch)(),t=Object(l.useSelector)(xt);return Object(n.useEffect)((function(){e(Y())}),[e]),{isPromoFetching:Object(l.useSelector)(Ht),promoError:Object(l.useSelector)(Ut),promo:t}}(),t=e.isPromoFetching,a=e.promoError,r=e.promo;return t?c.a.createElement(ta,null):a?c.a.createElement(ja,null,a.message):c.a.createElement(Fa,{promo:r})},Ra=function(){var e=Object(l.useDispatch)(),t=Object(l.useSelector)(Ea);Object(n.useEffect)((function(){e(se())}),[e]);var a=Object(l.useSelector)(ma);return{isFilmsFetching:Object(l.useSelector)(ua),filmsError:a,films:t}},Aa=Object(n.memo)((function(e){var t=e.film,a=t.get("name"),r=t.get("id"),n=Pt(r);return c.a.createElement("article",{className:"small-movie-card catalog__movies-card",title:a},c.a.createElement("div",{className:"small-movie-card__image",onClick:n},c.a.createElement("img",{src:t.get("preview_image"),alt:a,width:"280",height:"175"})),c.a.createElement("h3",{className:"small-movie-card__title"},c.a.createElement("a",{className:"small-movie-card__link"},a)))})),Na=Object(n.memo)((function(e){var t=e.films.map((function(e){return c.a.createElement(Aa,{key:e.get("id"),film:e})}));return c.a.createElement("div",{className:"catalog__movies-list"},t)})),Ha=function(){var e,t,a=Ra(),r=a.isFilmsFetching,i=a.filmsError,s=a.films,o=function(){var e=Object(n.useState)(20),t=Object(Gt.a)(e,2),a=t[0],r=t[1];return{batch:a,requestNextBatch:function(){return r((function(e){return e+20}))}}}(),u=o.batch,m=o.requestNextBatch,E=Object(l.useSelector)(fa),d=Object(n.useCallback)(m,[]);return Qt(s)&&(t=(e=E.slice(0,u)).size<E.size),r?c.a.createElement(ta,null):i?c.a.createElement(ja,null,i.message):c.a.createElement(c.a.Fragment,null,Qt(s)&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Na,{films:e}),c.a.createElement("div",{className:"catalog__more"},t&&c.a.createElement("button",{className:"catalog__button",type:"button",onClick:d,title:"Show more"},"Show more"))),!Qt(s)&&c.a.createElement(ja,null,"We are sorry. There aren't available films now."))},Ua=function(){var e,t=Object(l.useSelector)(da),a=Object(l.useSelector)(ma),r=Object(l.useSelector)(ua),i=function(){var e=Object(l.useSelector)(_a),t=Object(l.useDispatch)(),a=Object(n.useCallback)((function(a){a!==e&&t(ue(a))}),[t,e]);return{filter:e,genreItemClickHander:a}}(),s=i.filter,o=i.genreItemClickHander;return a||r?null:(function(e){return void 0!==e}(t)&&(e=t.map((function(e){var t=e===s,a=Ct()("catalog__genres-item",{"catalog__genres-item--active":t}),r=t?{cursor:"default"}:{};return c.a.createElement("li",{className:a,key:e},c.a.createElement("a",{className:"catalog__genres-link",onClick:function(){return o(e)},title:t?"":e,style:r},e))}))),c.a.createElement("ul",{className:"catalog__genres-list"},e))},xa=function(){var e=It(),t=Object(Ft.useLocation)().pathname==="".concat("/whattowatch").concat(x.MAIN_PAGE);return c.a.createElement("footer",{className:"page-footer"},c.a.createElement(kt,{isMainPage:t,logoLinkClickHandler:e,isFooter:!0}),c.a.createElement("div",{className:"copyright"},c.a.createElement("p",null,"\xa9 2020 What to watch Ltd.")))},Ia=function(){var e=Object(l.useSelector)(xt),t={};if(e){var a=e.get("background_color");t={backgroundImage:"linear-gradient(-180deg, ".concat(a," 0%, ").concat(a," 100%)")}}return c.a.createElement(c.a.Fragment,null,c.a.createElement("section",{className:"movie-card"},c.a.createElement(Lt,null),c.a.createElement(ya,null)),c.a.createElement("div",{className:"page-content",style:t},c.a.createElement("section",{className:"catalog"},c.a.createElement("h2",{className:"catalog__title visually-hidden"},"Catalog"),c.a.createElement(Ua,null),c.a.createElement(Ha,null)),c.a.createElement(xa,null)))},ka=a(18),Pa=a(46),La={initialValues:{email:"",password:""},schema:Object(Pa.a)().shape({email:Object(Pa.b)().min(6,"Email should be more than 6 characters").required("Email is required field").email("Invalid email").trim(),password:Object(Pa.b)().min(6,"Password should be more than 6 characters").max(15,"Password should be less than 15 characters").required("Password is required field").trim()})},Va={initialValues:{rating:"","review-text":""},schema:Object(Pa.a)().shape({rating:Object(Pa.b)().required("Rating is required"),"review-text":Object(Pa.b)().min(50,"Review should be more than 50 characters").max(400,"Review should be less than 400 characters").required("Review is required field").trim()})},Ma=Object(n.memo)((function(e){var t=e.loginFormSubmitHandler;return c.a.createElement(ka.d,{initialValues:La.initialValues,onSubmit:t,validationSchema:La.schema},(function(e){var t=e.isValid;return c.a.createElement(ka.c,{className:"sign-in__form"},c.a.createElement(ka.a,{name:"email"},(function(e){return c.a.createElement("div",{className:"sign-in__message"},c.a.createElement("p",null,e))})),c.a.createElement(ka.a,{name:"password"},(function(e){return c.a.createElement("div",{className:"sign-in__message"},c.a.createElement("p",null,e))})),c.a.createElement("div",{className:"sign-in__fields"},c.a.createElement("div",{className:"sign-in__field"},c.a.createElement(ka.b,{className:"sign-in__input",type:"email",placeholder:"Email address",name:"email",id:"user-email"}),c.a.createElement("label",{className:"sign-in__label visually-hidden",htmlFor:"user-email"},"Email address")),c.a.createElement("div",{className:"sign-in__field"},c.a.createElement(ka.b,{className:"sign-in__input",type:"password",placeholder:"Password",name:"password",id:"user-password"}),c.a.createElement("label",{className:"sign-in__label visually-hidden",htmlFor:"user-password"},"Password"))),c.a.createElement("div",{className:"sign-in__submit"},c.a.createElement("button",{className:"sign-in__btn",type:"submit",title:"Sign in",disabled:!t},"Sign in")))}))})),Da=function(){var e=function(){var e=Object(l.useDispatch)(),t=Object(n.useCallback)((function(t){var a=t.email,r=t.password;e(be({email:a,password:r}))}),[e]),a=Object(l.useSelector)(jt),r=Object(l.useSelector)(yt);return{isAuthFetching:Object(l.useSelector)(Rt),authError:r,user:a,loginFormSubmitHandler:t}}(),t=e.isAuthFetching,a=e.loginFormSubmitHandler;return t?c.a.createElement(ta,null):c.a.createElement("div",{className:"sign-in user-page__content"},c.a.createElement(Ma,{loginFormSubmitHandler:a}))},Wa=function(){var e=Object(l.useSelector)(jt),t=Object(l.useSelector)(yt),a=Object(l.useDispatch)();return Object(n.useEffect)((function(){a(we())}),[a]),e?c.a.createElement(Ft.Redirect,{to:"".concat("/whattowatch").concat(x.MAIN_PAGE)}):c.a.createElement("div",{className:"user-page"},c.a.createElement(Lt,null),t&&c.a.createElement(ja,null,t.message),!t&&c.a.createElement(Da,null),c.a.createElement(xa,null))},Qa=Object(n.memo)((function(e){var t=e.rating,a=e.scoresCount,r=e.description,n=e.director,i=e.starring;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"movie-rating"},c.a.createElement("div",{className:"movie-rating__score"},t),c.a.createElement("p",{className:"movie-rating__meta"},c.a.createElement("span",{className:"movie-rating__level"},function(e){switch(Math.floor(e)){case 10:return"Awesome";case 9:case 8:return"Very good";case 7:case 6:case 5:return"Good";case 4:case 3:return"Normal";case 2:case 1:case 0:return"Bad"}return"User's mark"}(+t)),c.a.createElement("span",{className:"movie-rating__count"},"".concat(a," ratings")))),c.a.createElement("div",{className:"movie-card__text"},c.a.createElement("p",null,r),c.a.createElement("p",{className:"movie-card__director"},c.a.createElement("strong",null,"Director: ".concat(n))),c.a.createElement("p",{className:"movie-card__starring"},c.a.createElement("strong",null,"Starring: ".concat(i.join(", "))))))})),Ga=Object(n.memo)((function(e){var t=e.released,a=e.runTime,r=e.genre,n=e.director,i=e.starring;return c.a.createElement("div",{className:"movie-card__text movie-card__row"},c.a.createElement("div",{className:"movie-card__text-col"},c.a.createElement("p",{className:"movie-card__details-item"},c.a.createElement("strong",{className:"movie-card__details-name"},"Director"),c.a.createElement("span",{className:"movie-card__details-value"},n)),c.a.createElement("p",{className:"movie-card__details-item"},c.a.createElement("strong",{className:"movie-card__details-name"},"Starring"),c.a.createElement("span",{className:"movie-card__details-value"},i.join(",\n")))),c.a.createElement("div",{className:"movie-card__text-col"},c.a.createElement("p",{className:"movie-card__details-item"},c.a.createElement("strong",{className:"movie-card__details-name"},"Run Time"),c.a.createElement("span",{className:"movie-card__details-value"},Dt(a))),c.a.createElement("p",{className:"movie-card__details-item"},c.a.createElement("strong",{className:"movie-card__details-name"},"Genre"),c.a.createElement("span",{className:"movie-card__details-value"},r)),c.a.createElement("p",{className:"movie-card__details-item"},c.a.createElement("strong",{className:"movie-card__details-name"},"Released"),c.a.createElement("span",{className:"movie-card__details-value"},t))))})),Ba=function(e){return e.reviews.get("isReviewsFetching")},qa=function(e){return e.reviews.get("reviewsError")},Ja=function(e){return e.reviews.getIn(["reviews","data"])},za=function(e){return e.reviews.getIn(["reviews","id"])},Za=function(e){return e.reviews.get("isReviewFetching")},Ya=function(e){return e.reviews.get("reviewError")},Ka=Object(n.memo)((function(e){var t,a=e.review,r=new Date(Date.parse(a.get("date"))),n=r.getFullYear(),i=r.getMonth(),s=r.getDate();return c.a.createElement("div",{className:"review"},c.a.createElement("blockquote",{className:"review__quote"},c.a.createElement("p",{className:"review__text"},a.get("comment")),c.a.createElement("footer",{className:"review__details"},c.a.createElement("cite",{className:"review__author"},a.getIn(["user","name"])),c.a.createElement("time",{className:"review__date",dateTime:"".concat(n,"-").concat(i+1,"-").concat(s)},"".concat((t=i,["January","February","March","April","May","June","July","August","September","October","November","December"][t])," ").concat(s,", ").concat(n)))),c.a.createElement("div",{className:"review__rating"},a.get("rating")))})),Xa=Object(n.memo)((function(e){var t,a,r,i=function(e){var t=Object(l.useDispatch)(),a=Object(l.useSelector)(Ja),r=Object(l.useSelector)(za);Object(n.useEffect)((function(){r!==e&&t(ke(e))}),[t,e,r,a]);var c=Object(l.useSelector)(qa);return{isReviewsFetching:Object(l.useSelector)(Ba),reviewsError:c,reviews:a}}(e.id),s=i.isReviewsFetching,o=i.reviewsError,u=i.reviews;return s?c.a.createElement(ta,null):o?c.a.createElement(ja,null,o.message):(function(e){return 0!==e.size}(u)&&(a=(t=u.sort((function(e,t){return Date.parse(t.get("date"))-Date.parse(e.get("date"))})).map((function(e){return c.a.createElement(Ka,{review:e,key:e.get("id")})}))).filter((function(e,t){return!(t%2)})),r=t.filter((function(e,t){return t%2}))),c.a.createElement("div",{className:"movie-card__reviews movie-card__row"},t&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"movie-card__reviews-col"},a),c.a.createElement("div",{className:"movie-card__reviews-col"},r)),!t&&c.a.createElement(ja,null,"No reviews yet. Your will be the first!")))})),$a=Object(n.memo)((function(e){var t=e.film,a=Object(n.useState)("Overview"),r=Object(Gt.a)(a,2),i=r[0],s=r[1];Object(n.useEffect)((function(){window.scrollTo(0,0)}),[t]),Object(n.useEffect)((function(){return function(){s("Overview")}}),[t]),function(e){var t=Object(l.useDispatch)(),a=Object(l.useSelector)(va);Object(n.useEffect)((function(){a&&a.get("id")===e.get("id")||t(me(e))}),[t,e,a])}(t);var o=ra(),u=o.isPlaying,m=o.handleExitBtnClick,E=o.playBtnClickHandler,d=o.videoRef,_=o.isVideoLoading,v=o.onCanPlayThroughHandler,f=Object(n.useCallback)((function(e){s(e)}),[]),p=t.get("poster_image"),b=t.get("name"),h=t.get("genre"),g=t.get("released"),S=t.get("run_time"),O=t.get("director"),T=t.get("starring"),F=["Overview","Details","Reviews"].map((function(e){var t=e===i,a=Ct()("movie-nav__item",{"movie-nav__item--active":t}),r=t?{cursor:"default"}:{};return c.a.createElement("li",{className:a,key:e},c.a.createElement("a",{className:"movie-nav__link",onClick:function(){return f(e)},title:t?"":e,style:r},e))}));return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"movie-card__hero"},c.a.createElement(Lt,{film:t}),c.a.createElement("div",{className:"movie-card__wrap"},c.a.createElement("div",{className:"movie-card__desc"},c.a.createElement("h2",{className:"movie-card__title"},b),c.a.createElement("p",{className:"movie-card__meta"},c.a.createElement("span",{className:"movie-card__genre"},h),c.a.createElement("span",{className:"movie-card__year"},g)),c.a.createElement("div",{className:"movie-card__buttons"},c.a.createElement(Ta,{playBtnClickHandler:E,detailed:!0}))))),c.a.createElement("div",{className:"movie-card__wrap movie-card__translate-top"},c.a.createElement("div",{className:"movie-card__info"},c.a.createElement("div",{className:"movie-card__poster movie-card__poster--big"},c.a.createElement("img",{src:p,alt:"".concat(b," poster"),width:"218",height:"327"})),c.a.createElement("div",{className:"movie-card__desc"},c.a.createElement("nav",{className:"movie-nav movie-card__nav"},c.a.createElement("ul",{className:"movie-nav__list"},F)),"Overview"===i&&c.a.createElement(Qa,{rating:t.get("rating").toFixed(1),scoresCount:t.get("scores_count"),description:t.get("description"),director:O,starring:T}),"Details"===i&&c.a.createElement(Ga,{genre:h,released:g,runTime:S,director:O,starring:T}),"Reviews"===i&&c.a.createElement(Xa,{id:t.get("id")})),c.a.createElement(aa,{src:t.get("video_link"),posterImage:p,runTime:S,ref:d,handleExitBtnClick:m,onCanPlayThroughHandler:v,isVideoLoading:_,isPlaying:u}))))})),er=Object(n.memo)((function(e){var t=e.film,a=Object(l.useSelector)(function(e){return Object(na.a)(Ea,(function(t){if(Qt(t))return t.filter((function(t){return t.get("genre")===e.get("genre")&&t!==e})).slice(0,4)}))}(t)),r=a.map((function(e){return c.a.createElement(Aa,{key:e.get("id"),film:e})}));return Qt(a)?c.a.createElement("section",{className:"catalog catalog--like-this"},c.a.createElement("h2",{className:"catalog__title"},"More like this"),c.a.createElement("div",{className:"catalog__movies-list"},r)):null})),tr=function(){var e,t=Object(Ft.useParams)().id,a=Ra(),r=a.isFilmsFetching,n=a.filmsError,i=a.films;if(r)return c.a.createElement("div",{className:"movie-card__hero"},c.a.createElement(Lt,null),c.a.createElement(ta,null));if(n)return c.a.createElement("div",{className:"movie-card__hero"},c.a.createElement(Lt,null),c.a.createElement(ja,null,n.message));if(Qt(i)&&(e=i.find((function(e){return e.get("id")===+t}))),!e)return c.a.createElement(Ft.Redirect,{to:"".concat("/whattowatch").concat(x.MAIN_PAGE)});var s=e.get("background_color"),l={backgroundImage:"linear-gradient(-180deg, ".concat(s," 0%, ").concat(s," 100%)")},o={backgroundColor:s};return c.a.createElement(c.a.Fragment,null,c.a.createElement("section",{className:"movie-card movie-card--full",style:o},c.a.createElement($a,{film:e})),c.a.createElement("div",{className:"page-content",style:l},c.a.createElement(er,{film:e}),c.a.createElement(xa,null)))},ar=Object(n.memo)((function(e){var t=e.value,a=e.groupValue,r=e.disabled,n=e.field,i=n.onChange,s=n.onBlur;return c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{className:"rating__input",id:"star-".concat(t),type:"radio",name:"rating",value:t,checked:t===+a,onChange:i,onBlur:s,disabled:r}),c.a.createElement("label",{className:"rating__label",htmlFor:"star-".concat(t)},"Rating-".concat(t)))})),rr=Object(n.memo)((function(e){var t=e.isReviewFetching,a=e.reviewFormSubmitHandler;return c.a.createElement(ka.d,{initialValues:Va.initialValues,onSubmit:a,validationSchema:Va.schema},(function(e){var a=e.values,r=e.isValid;return c.a.createElement(ka.c,{className:"add-review__form"},c.a.createElement(ka.a,{name:"rating"},(function(e){return c.a.createElement("div",{className:"review__message"},e)})),c.a.createElement(ka.a,{name:"review-text"},(function(e){return c.a.createElement("div",{className:"review__message"},e)})),c.a.createElement("div",{className:"rating"},c.a.createElement("div",{className:"rating__stars"},n.Children.toArray(new Array(5).fill("").map((function(e,r){return c.a.createElement(ka.b,{component:ar,value:5-r,groupValue:a.rating,disabled:t})}))))),c.a.createElement("div",{className:"add-review__text"},c.a.createElement(ka.b,{className:"add-review__textarea",as:"textarea",name:"review-text",id:"review-text",placeholder:"Review text",disabled:t}),c.a.createElement("div",{className:"add-review__submit"},c.a.createElement("button",{className:"add-review__btn",type:"submit",title:"Post",disabled:!r||t},"Post"))))}))})),nr=function(){var e=Object(Ft.useParams)().id,t=function(){var e=Object(l.useDispatch)(),t=Object(n.useCallback)((function(t,a){e(Ve(t,a))}),[e]),a=Object(l.useSelector)(Ya);return{isReviewFetching:Object(l.useSelector)(Za),reviewError:a,reviewFormSubmitHandler:t}}(),a=t.isReviewFetching,r=t.reviewFormSubmitHandler,i=a,s=Object(n.useCallback)((function(t){r(+e,t)}),[e,r]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(rr,{isReviewFetching:i,reviewFormSubmitHandler:s}),a&&c.a.createElement(Oa,null,"Sending your review... Please, wait."))},cr=function(){var e,t=Object(l.useSelector)(jt),a=Object(l.useSelector)(Ea),r=Object(l.useSelector)(Ya),i=Object(l.useDispatch)(),s=Object(Ft.useParams)().id;Object(n.useEffect)((function(){i(We())}),[i]);var o={};Qt(a)&&(o={backgroundColor:(e=a.find((function(e){return e.get("id")===+s}))).get("background_color")});return t?c.a.createElement("section",{className:"movie-card movie-card--full",style:o},c.a.createElement("div",{className:"movie-card__header"},c.a.createElement(Lt,{film:e})),r&&c.a.createElement(ja,null,r.message),!r&&c.a.createElement("div",{className:"add-review"},c.a.createElement(nr,null)),c.a.createElement(xa,null)):c.a.createElement(Ft.Redirect,{to:"".concat("/whattowatch").concat(x.LOGIN_PAGE)})},ir=function(){var e,t=function(){var e=Object(l.useDispatch)(),t=Object(l.useSelector)(sa);Object(n.useEffect)((function(){e($e())}),[e]);var a=Object(l.useSelector)(ia);return{isFavoritesFetching:Object(l.useSelector)(ca),favoritesError:a,favorites:t}}(),a=t.isFavoritesFetching,r=t.favoritesError,i=t.favorites;return a?c.a.createElement(ta,null):r?c.a.createElement(ja,null,r.message):Qt(i)?(e=i,c.a.createElement(Na,{films:e})):c.a.createElement(ja,null,"Your list of favorite films is empty!")},sr=function(){return Object(l.useSelector)(jt)?c.a.createElement("div",{className:"user-page"},c.a.createElement(Lt,null),c.a.createElement("section",{className:"catalog"},c.a.createElement("h2",{className:"catalog__title visually-hidden"},"Catalog"),c.a.createElement(ir,null)),c.a.createElement(xa,null)):c.a.createElement(Ft.Redirect,{to:"".concat("/whattowatch").concat(x.LOGIN_PAGE)})},lr=function(){return function(){var e=Object(l.useDispatch)();Object(n.useEffect)((function(){e(Se())}),[e])}(),c.a.createElement(Ft.Switch,null,c.a.createElement(Ft.Route,{path:"".concat("/whattowatch").concat(x.MAIN_PAGE),component:Ia,exact:!0}),c.a.createElement(Ft.Route,{path:"".concat("/whattowatch").concat(x.LOGIN_PAGE),component:Wa,exact:!0}),c.a.createElement(Ft.Route,{path:"".concat("/whattowatch").concat(x.FILM_PAGE),component:tr,exact:!0}),c.a.createElement(Ft.Route,{path:"".concat("/whattowatch").concat(x.REVIEW_PAGE),component:cr,exact:!0}),c.a.createElement(Ft.Route,{path:"".concat("/whattowatch").concat(x.FAVORITES_PAGE),component:sr,exact:!0}),c.a.createElement(Ft.Redirect,{to:"".concat("/whattowatch").concat(x.MAIN_PAGE)}))},or=a(103),ur=a(104),mr=a(107),Er=a(105),dr=function(e){Object(mr.a)(a,e);var t=Object(Er.a)(a);function a(){var e;Object(or.a)(this,a);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).state={isError:!1},e}return Object(ur.a)(a,[{key:"render",value:function(){return this.state.isError?c.a.createElement(ja,null,"We are sorry. Our application isn't available now. Please, reload the page."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(){return{isError:!0}}}]),a}(c.a.PureComponent);s.a.render(c.a.createElement(l.Provider,{store:St},c.a.createElement(dr,null,c.a.createElement(o.ConnectedRouter,{history:M},c.a.createElement(u.a,{persistor:Ot,loading:c.a.createElement(ta,null)},c.a.createElement(lr,null))))),document.querySelector("#root"))}},[[108,1,2]]]);
//# sourceMappingURL=main.33d621f4.chunk.js.map